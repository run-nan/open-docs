---
title: 插件文件操作
order: 5
group:
    title: 基础能力
    order: 1
---

| 能力代号 | 能力名称     |
| -------- | ------------ |
| File     | 插件文件操作 |

## 能力描述

提供插件文件相关操作能力，相对路径目录： `[当前插件]/workspace` 。

## 能力声明

```ts
import {
  appendBytes,
  createFile,
  isDir,
  isExist,
  isFile,
  makeDir,
  readLines,
  writeBytes,
  writeStrings,
  appendStrings,
  read,
  list,
  copy,
  remove,
  rename,
} from '@ones-op/node-file'
```

## API

### createFile

创建文件。

example: 

```ts
createFile('test.txt')
```

入参

| 参数  | 类型     | 说明   | 默认值 |
| :---- | -------- | ------ | ------ |
| name* | `string` | 文件名 | -      |

返回

| 参数 | 类型   | 说明 |
| ---- | ------ | ---- |
| data | `void` | -    |

### makeDir

创建文件夹。

example: 

```ts
makeDir('./tmp/test')
```

入参

| 参数  | 类型     | 说明                       | 默认值 |
| :---- | -------- | -------------------------- | ------ |
| path* | `string` | 文件夹路径（支持递归创建） | -      |

返回

| 参数 | 类型   | 说明 |
| ---- | ------ | ---- |
| data | `void` | -    |

### rename

修改文件名。

example: 

```ts
rename('./tmp/test/test.txt', './tmp/test/test1.txt')
```

入参

| 参数          | 类型     | 说明       | 默认值 |
| :------------ | -------- | ---------- | ------ |
| originalPath* | `string` | 原文件路径 | -      |
| newPath*      | `string` | 新文件路径 | -      |

返回

| 参数 | 类型   | 说明 |
| ---- | ------ | ---- |
| data | `void` | -    |

### remove

移除文件。

example: 

```ts
remove('./tmp/test/test.txt')
```

入参

| 参数  | 类型     | 说明             | 默认值 |
| :---- | -------- | ---------------- | ------ |
| name* | `string` | 待删除的文件路径 | -      |

返回

| 参数 | 类型   | 说明 |
| ---- | ------ | ---- |
| data | `void` | -    |

### isExist

判断文件是否存在。

example: 

```ts
Logger.info('isExist', await isExist('./tmp/test/test.txt'))
```

入参

| 参数  | 类型     | 说明             | 默认值 |
| :---- | -------- | ---------------- | ------ |
| name* | `string` | 待判断的文件路径 | -      |

返回

| 参数 | 类型      | 说明 |
| ---- | --------- | ---- |
| data | `boolean` | -    |

### isFile

判断是否是文件类型。

example: 

```ts
Logger.info('isExist', await isFile('./tmp/test/test.txt'))
```

入参

| 参数  | 类型     | 说明             | 默认值 |
| :---- | -------- | ---------------- | ------ |
| name* | `string` | 待判断的文件路径 | -      |

返回

| 参数 | 类型      | 说明 |
| ---- | --------- | ---- |
| data | `boolean` | -    |

### isDir

判断是否是文件夹类型。

example: 

```ts
Logger.info('isExist', await isDir('./tmp/test'))
```

入参

| 参数  | 类型     | 说明             | 默认值 |
| :---- | -------- | ---------------- | ------ |
| name* | `string` | 待判断的文件路径 | -      |

返回

| 参数 | 类型      | 说明 |
| ---- | --------- | ---- |
| data | `boolean` | -    |

### copy

复制文件。

example: 

```ts
copy('./tmp/test/test.txt', './tmp/test/test2.txt')
```

入参

| 参数          | 类型     | 说明       | 默认值 |
| :------------ | -------- | ---------- | ------ |
| originalPath* | `string` | 原文件路径 | -      |
| newPath*      | `string` | 新文件路径 | -      |

返回

| 参数 | 类型   | 说明 |
| ---- | ------ | ---- |
| data | `void` | -    |

### list

获取文件夹目录。

example: 

```ts
list('./tmp/test'))
```

入参

| 参数  | 类型     | 说明       | 默认值 |
| :---- | -------- | ---------- | ------ |
| path* | `string` | 文件夹路径 | -      |

返回

| 参数 | 类型       | 说明 |
| ---- | ---------- | ---- |
| data | `string[]` | -    |

### read

读取文件。

example: 

```ts
Logger.info('read', Unit8Array2String(await read('./tmp/test/test.txt')))
```

入参

| 参数  | 类型     | 说明     | 默认值 |
| :---- | -------- | -------- | ------ |
| name* | `string` | 文件路径 | -      |

返回

| 参数 | 类型         | 说明 |
| ---- | ------------ | ---- |
| data | `Uint8Array` | -    |

### readLines

读取文件指定范围行。

example: 

```ts
readLines('./tmp/test/test.txt', 0, 1)
```

入参

| 参数       | 类型     | 说明     | 默认值 |
| :--------- | -------- | -------- | ------ |
| name*      | `string` | 文件路径 | -      |
| lineBegin* | `number` | 起始行数 | -      |
| lineEnd*   | `number` | 截止行数 |        |

返回

| 参数 | 类型         | 说明 |
| ---- | ------------ | ---- |
| data | `Uint8Array` | -    |

### writeStrings

文件写入字符串。

example: 

```ts
writeStrings('./tmp/test/test.txt', ['hello world!'])
```

入参

| 参数     | 类型       | 说明       | 默认值 |
| :------- | ---------- | ---------- | ------ |
| name*    | `string`   | 文件路径   | -      |
| content* | `string[]` | 待写入内容 | -      |

返回

| 参数 | 类型   | 说明 |
| ---- | ------ | ---- |
| data | `void` | -    |

### appendStrings

文件追加写入字符串。

example: 

```ts
appendStrings('./tmp/test/test.txt', ['hello world!'])
```

入参

| 参数     | 类型       | 说明       | 默认值 |
| :------- | ---------- | ---------- | ------ |
| name*    | `string`   | 文件路径   | -      |
| content* | `string[]` | 待写入内容 | -      |

返回

| 参数 | 类型   | 说明 |
| ---- | ------ | ---- |
| data | `void` | -    |

### writeBytes

文件写入字节流。

example: 

```ts
writeBytes('./tmp/test/test.txt', String2Unit8Array('hello bytes!\n'))
```

入参

| 参数       | 类型         | 说明       | 默认值 |
| :--------- | ------------ | ---------- | ------ |
| name*      | `string`     | 文件路径   | -      |
| byteSlice* | `Uint8Array` | 待写入内容 | -      |

返回

| 参数 | 类型   | 说明 |
| ---- | ------ | ---- |
| data | `void` | -    |

### appendBytes

文件追加写入字节流。

example: 

```ts
appendBytes('./tmp/test/test.txt', String2Unit8Array('hello bytes!\n'))
```

入参

| 参数       | 类型         | 说明       | 默认值 |
| :--------- | ------------ | ---------- | ------ |
| name*      | `string`     | 文件路径   | -      |
| byteSlice* | `Uint8Array` | 待写入内容 | -      |

返回

| 参数 | 类型   | 说明 |
| ---- | ------ | ---- |
| data | `void` | -    |

### 完整Example

```ts
export async function TestFile() {
  try {
    await makeDir('./tmp/test')
    await createFile('./tmp/test/test.txt')
    await writeStrings('./tmp/test/test.txt', ['hello world!\n'])
    await appendStrings('./tmp/test/test.txt', ['hello world!'])
    await copy('./tmp/test/test.txt', './tmp/test/test2.txt')
    await copy('./tmp/test/test.txt', './tmp/test/test3.txt')
    await rename('./tmp/test/test3.txt', './tmp/test/test4.txt')
    await writeBytes('./tmp/test/test.txt', String2Unit8Array('hello bytes!\n'))
    await appendBytes('./tmp/test/test.txt', Object2Unit8Array({ name: 'hello bytes!' }))
    Logger.info('======List', await list('./tmp/test'))
    Logger.info('======isExist', await isExist('./tmp/test/test.txt'))
    Logger.info('======isDir', await isDir('./tmp'))
    Logger.info('======isDir', await isDir('./tmp/test'))
    Logger.info('======isDir', await isDir('./tmp/test/test.txt'))
    Logger.info('======isFile', await isFile('./tmp/test/test.txt'))
    Logger.info('======read', Unit8Array2String(await read('./tmp/test/test.txt') as Uint8Array))
    const lines = await readLines('./tmp/test/test.txt', 0, 1)
    Logger.info('======readLines', Unit8Array2String(lines))
    await remove('./tmp/test/test4.txt')
    Logger.info('======List', await list('./tmp/test'))
  } catch (error) {
    Logger.error('ERROR: testFile callback:', error)
  }

  return {
    body: {
      code: 200,
      data: 'ok',
    }
  }
}
```



## 示例插件

