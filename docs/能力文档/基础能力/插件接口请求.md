---
title: 外部Http访问
order: 4
group:
    title: 基础能力
    order: 1
---

| 能力代号 | 能力名称     |
| -------- | ------------ |
| Fetch    | 插件接口请求 |

## 能力描述

提供请求外部接口与请求 ONES 接口能力。

## 能力使用

### 声明

```ts
import { fetchHttp, fetchONES } from '@ones-op/node-fetch'
```

### API

#### fetchHttp

外部接口请求方法。

example: 

```ts
async function fetchBaidu() {
  const response = await fetch({
    url: 'https://www.baidu.com',
    method: 'GET',
  })
	return response
}
```

入参

| 参数    | 类型                             | 说明     | 默认值 |
| :------ | -------------------------------- | -------- | ------ |
| url*    | `string`                         | 请求地址 | -      |
| method* | `string`                         | 请求类型 | -      |
| body    | `object \| Uint8Array \| string` | 请求体   | -      |
| headers | `Record<string, string[]>`       | 请求头   | -      |

返回

| 参数       | 类型                             | 说明   |
| ---------- | -------------------------------- | ------ |
| body       | `object \| Uint8Array \| string` | 返回体 |
| headers    | `Record<string, string[]>`       | 返回头 |
| statusCode | `number \| string \| undefined`  | 状态码 |

#### fetchONES

ONES 接口请求方法。

example: 

```ts
async function fetchONESDefaultView() {
  const response = await fetchONES(
      {
        path: `/team/${globalThis.onesEnv.teamUUID}/items/view`,
        method: 'POST',
        body: {
          query: {
            must: [
              { equal: { item_type: 'field' } },
              { in: { pool: ['project'] } },
              { in: { 'context.type': ['team'] } },
            ],
          },
          view: ['[default]'],
        },
        root: true,
      }
    )

	return response
}
```

入参

| 参数    | 类型                             | 说明                 | 默认值 |
| :------ | -------------------------------- | -------------------- | ------ |
| path*   | `string`                         | 请求路径             | -      |
| method* | `string`                         | 请求类型             | -      |
| body    | `object \| Uint8Array \| string` | 请求体               | -      |
| headers | `Record<string, string[]>`       | 请求头               | -      |
| root    | `boolean`                        | 是否以管理员权限请求 | false  |

返回

| 参数       | 类型                             | 说明   |
| ---------- | -------------------------------- | ------ |
| body       | `object \| Uint8Array \| string` | 返回体 |
| headers    | `Record<string, string[]>`       | 返回头 |
| statusCode | `number \| string \| undefined`  | 状态码 |

## 示例插件

