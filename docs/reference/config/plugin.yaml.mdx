---
sidebar_position: 1
---

import Image from '@theme/IdealImage'

# plugin.yaml

The plugin configuration file describes the abilities, modules and other related information used in the plugin. The Open Platform will consume the content of the file when the plugin installation and enablement will be installed and enabled.

File path and structure:

```yaml title="/config/plugin.yaml"
service:
  app_id: '********'
  version: 1.0.0
  name: MyPluginName
  description: MyPluginDescription
  language: nodejs
  language_version: 16.13.0
  host_version: 1.0.0
  host_sub_version: 1.0.0
  min_system_version: 3.5.0
  contact: MyContactInformation
  config:
    - key: MyCustomConfigKey
      type: Input
abilities:
  - id: Simple-login-SXgh
    name: SimpleLoginVerification
    abilityType: SimpleAuth
    function:
      validateFunc: SimpleAuthValidate
apis:
  - type: addition
    methods:
      - GET
    url: /hello
    function: HelloWorld
modules:
  - id: ones-global-banner-GXvd
    title: example banner title
    moduleType: ones:global:banner
    entry: modules/ones-global-banner-GXvd/index.html
```

## service

The basic information configuration of the plugin, the parameters are as follows:

### app_id

- **Type:** `string`

The unique ID of the plugin is automatically generated by the cli. You are not advised to change it.

The two plugins, even if the name is the same, if the `app_id` is different, they will be recognized as different plugins; on the contrary, if the` app_id` is consistent, whether the name is the same, they will be recognized as the same plugin.

If a plugin needs to be upgraded, it is necessary to ensure that the `app_id` of the new and old versions must be consistent, otherwise the open platform will be deemed to be installed as a new plugin.

### version

- **Type:** `string`

The plugin version, it is recommended to follow [Semantic Versioning 2.0.0](http://semver.org/).

### name

- **Type:** `string`

The plugin name will be displayed on the Plugin Management and Details page.

### description

- **Type:** `string`

The plugin description will be displayed on the Plugin Management and Details page.

### scope

- **Type:** `1 | 2`

The scope of the plugin.

| Type | Description                                                                                                                                                   |
| ---- | :------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 1    | Team-level plugin, can only be installed under the "Configuration Center" => "Plugin Management", and can only take effect on the current team                |
| 2    | Organizational-level plugin can only be installed under "Organization Management" => "Plugin Management", and take effect on all teams under the organization |

### language

- **Type:** `'nodejs'`

The development language of the plugin currently only supports Node.js, which generally does not need to be modified.

### host_version

- **Type:** `string`

The lowest version number of the Open Platform is generally not modified.

When the plugin is enabled, it will run on the HOST of the highest digit patch version, which is similar to the `~version` of [npm](https://docs.npmjs.com/about-semantic-versioning).

**Example:**

If your current `host_version` version is `1.0.4`.

The server has the following HOST versions:

- `1.0.3`
- `1.0.4`
- `1.0.5`
- `1.1.0`
- `2.0.0`

Then your plugin will run on the HOST of the `1.0.5` version.

### contact

- **Type:** `string`
- **Max:** `255`

The contact information displayed by the plugin log (support multi-line text).

**Example:**

```yaml title="/config/plugin.yaml"
service:
  contact: |-
    email: support@ones.com
    Call: 400-188-1518
```

<Image img={require('./images/contact-us.png')} />

### config

- **Type:** `Config[]`

The configuration item array of the plugin custom configuration, you can quickly provide some plugin custom configuration items by declare this configuration. For more information, please see the [Plugin Custom Configuration](../../abilities/basic/custom-config.mdx) document.

:::note
The configuration can only be modified when the plugin is stopped.
:::

**`Config` Params:**

|   Key    | Description           |               Type                | Required | Default |
| :------: | :-------------------- | :-------------------------------: | :------: | :-----: |
|   key    | Unique identification |             `string`              |   Yes    |         |
|   type   | Control type          | `'Input'｜'TextArea'｜'Password'` |   Yes    |         |
| required | Is this required      |             `boolean`             |    No    | `false` |
|  label   | Alias                 |             `string`              |    No    |  `key`  |
|  value   | Default               |             `string`              |    No    |         |

**Example:**

```yaml title="/config/plugin.yaml"
service:
  config:
    - key: exampleConfigKey
      label: my example key
      type: Input
```

**Result:**

<Image img={require('./images/function-config.png')} />

### permission

- **Type:** `Permission[]`

Plugin custom standard permission point configuration item array, you can use this configuration quickly build your own plugin permission system, For more information, please see the [Plugin Custom Permission](../../abilities/business/permission/custom-permission/custom-permission.mdx) document.

**`Permission` Params:**

|  Key  | Description                  |   Type   | Required | Default |
| :---: | :--------------------------- | :------: | :------: | :-----: |
| name  | Permission name              | `string` |   Yes    |         |
| field | Permission unique identifier | `string` |   Yes    |         |
| desc  | Permission description       | `string` |    No    |         |

**Example:**

```yaml title="/config/plugin.yaml"
service:
  permission:
    - name: My custom read permission
      field: my-custom-read-permission-key
      desc: This is an example of custom read permission
    - name: My custom write permission
      field: my-custom-write-permission-key
```

Configuration entry (after the plugin is enabled):

<Image img={require('./images/custom-permission.png')} />

### language_version

- **Type:** `string`
- **Reserved Word**

Plugin version number of backend language.

### host_sub_version

- **Type:** `string`
- **Reserved Word**

Open platform HOST sub-version number.

### min_system_version

- **Type:** `string`
- **Reserved Word**

The minimum compatibility ONES system version.

### mode

- **Type:** `string`
- **Deprecated**

Plugin mode.

### logo

- **Type:** `string`
- **Deprecated**

Declaration plugin Logo.

If you need to modify the plugin LOGO, modify the `web/public/logo.svg` file under the [plugin structure](../../guide/structure.md).

### auth

- **Type:** `string`
- **Deprecated**

Plugin authorization statement.

## abilities

The plugin capacity configuration item **array**, the configuration parameters of a single ability are as follows:

### id {#abilitiesId}

- **Type:** `string`

A unique identifier of the plugin ability.

### name

- **Type:** `string`

The ability name of the plugin.

### label

- **Type:** `string`
- **Reserved Word**

The ability alias of the plugin.

### relateModule

- **Type:** `string`

The [Plugin Module ID](#moduleId) used with the current ability binding is configured according to specific ability requirements, and generally no modification is required.

### version

- **Type:** `string`

Plugin ability version when the cli adding ability, it is automatically generated by the cli, and generally does not need to be modified.

### abilityType

- **Type:** `string`

Plugin ability type, it is automatically generated by the cli, and generally does not need to be modified.

### function

- **Type:** `Record<string, string>`

The method name of the ability to call the plugin ability is automatically generated by the cli. If the same ability is added many times, you need to manually modify the specified new method name.

### config {#abilitiesConfig}

- **Type:** `AbilityConfig[]`

Plugin ability configuration item, it is automatically generated by the cli

**`AbilityConfig` Params:**

|    Key    | Description                                             |    Type     | Required | Default |
| :-------: | :------------------------------------------------------ | :---------: | :------: | :-----: |
|    key    | Unique identification                                   |  `string`   |   Yes    |         |
| fieldType | Control type                                            | `FieldType` |   Yes    |         |
| required  | Is this required                                        |  `boolean`  |    No    | `false` |
|   label   | Alias                                                   |  `string`   |    No    |  `key`  |
|   value   | Default                                                 |  `string`   |    No    |         |
|   show    | Whether the plugin detail page shows this configuration |  `boolean`  |    No    | `true`  |

**`FieldType` Type:**

- `'Input'`：Single-line text
- `'TextArea'`：Multi-line text
- `'Password'`：Password input
- `'Number'`：Number input
- `'Select'`：Single select
- `'MultiSelect'`：Multiple select
- `'DatePicker'`：Date picker
- `'DateTimePicker'`：Date-time picker
- `'TimePicker'`：Time picker
- `'Switch'`：Switch

## apis

The interface configuration item of the plugin **array**, the configuration parameters of the single interface are as follows:

### type

- **Type:** `'external' ｜ 'addition' | 'replace' | 'prefix' | 'suffix'`

Tnterface type, For more information, please see the [Interface Registration](../../abilities/business/ONES-API/ONES-API-registration.md) document.

- `'external'`：The team level new interface (will check the login, and the URL needs to bring the `team/{teamUUID}` prefix)
- `'addition'`：The plugin level new interface
- `'replace'`：Replace the ONES standard interface (to be abandoned)
- `'prefix'`：ONES standard interface prefix interception (to be abandoned)
- `'suffix'`：ONES standard interface suffix interception (to be abandoned)

### methods

- **Type:** `('GET' | 'POST')[]`

The interface support request method can set multiple types at the same time.

### url

- **Type:** `string`
- **Example:** `/hello`

Interface access address.

### function

- **Type:** `string`

The call entry method name during interface access (this method must be `export` to be called by the Open Platform).

### scope

- **Type:** `'project' | 'wiki'`
- **Default (Inculde undefined):** `'project'`

The current interface is to modify the ONES standard interface (that is, [`type`](#type) is `'replace' | 'prefix' | 'suffix'`), you need to declare that the interface you currently modified `project` or `wiki` interface.

:::note
If it is a new interface with a plugin, this field is meaningless.
:::

## modules

The module configuration item of the plugin **array**, the single module configuration parameter is as follows:

### id {#moduleId}

- **Type:** `string`

The unique module ID within the plugin, it is automatically generated by the cli, and generally does not need to be modified.

### title

- **Type:** `string`

Module title.

### description {#moduleDescription}

- **Type:** `string`

Module description.

### icon

- **Type:** `string`
- **Example:** `./logo.svg`

Module icon address，the Open Platform will query `svg` icon resources through the relative path in the plugin `/web/public` directory.

### link

- **Type:** `string`

The jump link to a module, which is mutually exclusive with `entry`.

### entry

- **Type:** `string`

The module entry file path, and `link` mutually exclusive, it is automatically generated by the cli, and generally does not need to be modified.

### disabled

- **Type:** `boolean`

Module Specifies whether to disable modules of standard ONES.

:::caution
The new type of slot does not support the setting of `disabled`. If you need to remove the added plugin module, you can comment or delete the corresponding `module` under the modules.
:::

### manual

- **Type:** `boolean`

Whether the module is triggered by the user's specific operation and configuration according to specific capabilities, generally no modification is required.

### preload

- **Type:** `boolean`

Whether the module needs to be pre-loaded, this is usually used in conjunction with the `manual` and configured according to specific capabilities and needs. Generally, no modification is required.

### moduleType

- **Type:** `string`

Module Type, For optional values, see [Slot Module List](../../abilities/slot/slot.md), it is automatically generated by the cli, and generally does not need to be modified.

### permission {#modulePermission}

- **Type:** `string`

Permission identity, which works with the plugin [custom standard permission point configuration](#permission) or the plugin custom permission point ability, For more information, please see [here](../../abilities/business/permission/custom-permission/custom-permission.mdx).

**Example:**

With the [custom standard permission point configuration](#permission) to control the current module effectiveness permissions, administrators can control the "Effective Permission" permissions on the plugin permissions configuration page to control the effective user of the "ones-global-banner-GXvd" module.scope.

```yaml title="/config/plugin.yaml"
service:
  permission:
    - name: Effective Permission
      field: my-example-effective-permission-key
      desc: This is an example of custom effective permission
modules:
  - id: ones-global-banner-GXvd
    title: example banner title
    moduleType: ones:global:banner
    entry: modules/ones-global-banner-GXvd/index.html
    permisson: my-example-effective-permission-key
```

### modules {#subModule}

- **Type:** [`modules`](#modules)

Plugin sub-module, it is automatically generated by the cli, and generally does not need to be modified. For more information, please see [here](../../guide/abilities/add-slot.mdx#step-2-add-slot-submodule).

The slot needs this to represent the level for the complex slot that has different levels. For example, the My work app slot may have multiple top bars.

For more complicated hierarchical slots, you can use this field to represent hierarchical relationships. For example, the My work app slot may have multiple top bars.
