---
sidebar_position: 2
---

import Image from '@theme/IdealImage'

# 上传工作项附件

## 要求

| **ONES** |
| :------- |
| v3.6.0+  |

## 概述

通过使用该能力，插件能够将文件上传至工作项的附件中。

### 能力表现

通过能力上传文件之后，工作项中新增文件附件：

<Image img={require('./images/upload0.png')} />

## 使用

### 第一步：安装依赖

进入插件工程的`/backend`目录，执行以下命令进行依赖安装：

```shell
npm i @ones-op/node-ability
```

### 第二步：上传附件

调用 [uploadFile](../../../reference/packages/node-ability/node-ability.mdx#PluginFile_uploadFile) 方法将文件上传至某一工作项的附件中

```typescript
const file = await PluginFile.uploadFile('files/test.txt', 'taskuuid', 'desc')
```

- 参数介绍

  | **参数**    | **类型** | **说明**                                                             | **必填** | **默认值** |
  | :---------- | :------- | :------------------------------------------------------------------- | :------- | :--------- |
  | filePath    | string   | 文件地址，`workspace`目录下的路径                                    | 是       | -          |
  | referenceID | string   | 工作项的`uuid`                                                       | 是       | -          |
  | desc        | string   | 文件描述                                                             | 是       | -          |
  | teamUUID    | string   | 团队`uuid`，组织级别的插件必须带上该参数，团队级别的插件可不带该参数 | 是       | -          |

- 返回内容

  方法返回的结构体中包含本次上传文件的相关信息。

  | 参数    | 类型   | 说明            |
  | ------- | ------ | --------------- |
  | hash    | string | 文件的`hash`值  |
  | url     | string | 文件的下载`url` |
  | name    | string | 文件名称        |
  | size    | int    | 文件大小        |
  | mime    | string | 文件类型        |
  | version | int    | 文件版本        |
