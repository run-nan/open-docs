(self.webpackChunkopen_docs=self.webpackChunkopen_docs||[]).push([[50726],{84763:(e,t,i)=>{e.exports={src:{srcSet:i.p+"assets/ideal-img/script-field-float1.d338372.395.png 395w",images:[{path:i.p+"assets/ideal-img/script-field-float1.d338372.395.png",width:395,height:159}],src:i.p+"assets/ideal-img/script-field-float1.d338372.395.png",toString:function(){return i.p+"assets/ideal-img/script-field-float1.d338372.395.png"},placeholder:void 0,width:395,height:159},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAECAYAAAC3OK7NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAd0lEQVQImVWMOwoDIRgGPUYWHwiiRSw2kghB1keE4L94//N8C1ZJMUwzDEvHgTknWmtIKSHGiH3fF48Q4L2HUgqs1goiQu992VqL27ZBCAHO+bJcYSmgMXCehJwznHPQWq/LL+xVPkhj4v0l3FOBD08YYyCl/AsvIZk93ft+9SkAAAAASUVORK5CYII="}},71580:(e,t,i)=>{e.exports={src:{srcSet:i.p+"assets/ideal-img/script-field-float2.aa3a2aa.1024.png 1024w,"+i.p+"assets/ideal-img/script-field-float2.859f613.1227.png 1227w",images:[{path:i.p+"assets/ideal-img/script-field-float2.aa3a2aa.1024.png",width:1024,height:430},{path:i.p+"assets/ideal-img/script-field-float2.859f613.1227.png",width:1227,height:515}],src:i.p+"assets/ideal-img/script-field-float2.aa3a2aa.1024.png",toString:function(){return i.p+"assets/ideal-img/script-field-float2.aa3a2aa.1024.png"},placeholder:void 0,width:1024,height:430},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAECAYAAAC3OK7NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAaklEQVQImT3KSwrDMBAEUd3/frlCsgiWQeP5SZEqWAsvHgVNlybCpYqokZn03rfcTdST5oNS64GIoGpExHO8uSmfqrzeRjnqiZmjpvQxWGsx59x1dzKDtSblezbUgriEX9zjepgZak6MyR/GM5u0HWGKmQAAAABJRU5ErkJggg=="}},23234:(e,t,i)=>{"use strict";i.r(t),i.d(t,{assets:()=>f,contentTitle:()=>u,default:()=>g,frontMatter:()=>d,metadata:()=>c,toc:()=>m});var a=i(87462),l=(i(67294),i(3905)),n=i(15944),s=i(84763),o=i.n(s),r=i(71580),p=i.n(r);const d={sidebar_position:2},u="Float",c={unversionedId:"abilities/business/field/script-field-float/script-field-float",id:"version-1.x/abilities/business/field/script-field-float/script-field-float",title:"Float",description:"Requirements",source:"@site/versioned_docs/version-1.x/abilities/business/field/script-field-float/script-field-float.mdx",sourceDirName:"abilities/business/field/script-field-float",slug:"/abilities/business/field/script-field-float/",permalink:"/docs/abilities/business/field/script-field-float/",draft:!1,tags:[],version:"1.x",lastUpdatedBy:"liupengfei",lastUpdatedAt:1690791943,formattedLastUpdatedAt:"Jul 31, 2023",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"abilities",previous:{title:"Scene: field and field group of location",permalink:"/docs/abilities/business/field/script-field-selection/sample-script-field-selection"},next:{title:"Scene: Automatically count the number of relationships of a certain link type of issue",permalink:"/docs/abilities/business/field/script-field-float/sample-script-field-float"}},f={},m=[{value:"Requirements",id:"requirements",level:2},{value:"Overview",id:"overview",level:2},{value:"Scope",id:"scope",level:3},{value:"Performace",id:"performace",level:3},{value:"Usage",id:"usage",level:2},{value:"step 1: Add and use ability through the OP tool\uff1a",id:"step-1-add-and-use-ability-through-the-op-tool",level:3},{value:"Step 2: Modify plugin configuration file",id:"step-2-modify-plugin-configuration-file",level:3},{value:"step 3: Complete the script field calculation rule",id:"step-3-complete-the-script-field-calculation-rule",level:3},{value:"Examples",id:"examples",level:2},{value:"FAQ",id:"faq",level:2},{value:"What if you want to create multiple script fields?",id:"what-if-you-want-to-create-multiple-script-fields",level:5},{value:"What if there is an field with the same in the system?",id:"what-if-there-is-an-field-with-the-same-in-the-system",level:5}],h={toc:m};function g(e){let{components:t,...i}=e;return(0,l.kt)("wrapper",(0,a.Z)({},h,i,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"float"},"Float"),(0,l.kt)("h2",{id:"requirements"},"Requirements"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:"left"},"ONES"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"left"},"v3.6.0+")))),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,'This capability allows plugins to implement a special script field of type "',(0,l.kt)("strong",{parentName:"p"},"float"),"\", where the name and value of the field are determined solely by the plugin's code and cannot be modified by users in ONES. Plugin developers can implement different calculation rules for script property values to achieve diverse business development."),(0,l.kt)("p",null,"Use cases for float script properties:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Statistical calculations based on a specific rule"),(0,l.kt)("li",{parentName:"ol"},"Need for accurate values that cannot be manually modified")),(0,l.kt)("h3",{id:"scope"},"Scope"),(0,l.kt)("p",null,"Float script fields can only be added as ",(0,l.kt)("strong",{parentName:"p"},"issue")," fields."),(0,l.kt)("h3",{id:"performace"},"Performace"),(0,l.kt)("p",null,"You can add float script fields to specific issue types just like using system work issue fields."),(0,l.kt)(n.Z,{img:p(),mdxType:"Image"}),(0,l.kt)("p",null,"In most scenarios, script issue fields behave similarly to the system issue fields in the ONES system. However, there are slight differences in the following scenarios:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"In layout configuration, tagged fields do not support script fields."),(0,l.kt)("li",{parentName:"ul"},"In issue list view\uff0conly filtering based on script issue fields is supported, while sorting and grouping based on script issue fields are not supported."),(0,l.kt)("li",{parentName:"ul"},"Importing issues does not support importing issues that contain script issue fields."),(0,l.kt)("li",{parentName:"ul"},'In "Automation Settings", updating script issue fields and creating issues with pre-set script field values are not supported.'),(0,l.kt)("li",{parentName:"ul"},'In "My Work" - "Dashboard" - "Custom Report Card", using script issue fields as analysis dimensions is not supported.')),(0,l.kt)("h2",{id:"usage"},"Usage"),(0,l.kt)("p",null,"Add the ability through the OP tool, modify the configuration related to the ability, and complete the business logic in the script fields method, as shown below."),(0,l.kt)("h3",{id:"step-1-add-and-use-ability-through-the-op-tool"},"step 1: Add and use ability through the OP tool\uff1a"),(0,l.kt)("p",null,"Use the Command Line to enter the OP command in the plugin root directory to add ability (this directive requires OP tool version 1.0 or above)"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"npx op add ability\n")),(0,l.kt)("p",null,"Select and add ",(0,l.kt)("inlineCode",{parentName:"p"},"script-field-float@1.0.0")),(0,l.kt)(n.Z,{img:o(),mdxType:"Image"}),(0,l.kt)("p",null,"The OP tool will ask if you want to use the default value, just choose yes, and the OP tool will add the following to the plugin"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"The OP tool adds ",(0,l.kt)("inlineCode",{parentName:"p"},"abilitiy")," field related paragraphs in plugin configuration file ",(0,l.kt)("inlineCode",{parentName:"p"},"plugin.yaml")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="config/plugin.yaml"',title:'"config/plugin.yaml"'},"service:\n  app_id: ...\n  name: ability-scriptFloat\n  ...\napis:\n  ...\nabilities:\n  - id: ...\n    name: scriptField\n    version: 1.0.0\n    abilityType: ScriptFieldFloat\n    function:\n      calcFieldValue: calcFieldValues\n    config:\n      - key: FieldName\n        value: scriptField1\n        fieldType: Input\n        show: false\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"The OP tool adds file ",(0,l.kt)("inlineCode",{parentName:"p"},"script-field-float.ts")," to the plugin backend"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="backend/src/script-field-float.ts"',title:'"backend/src/script-field-float.ts"'},'import type { PluginRequest, PluginResponse } from \'@ones-op/node-types\'\n\n// example function:The calculation method of script floating point\n// Calculate field_uuid for more than one task at a time\n// Request format::\n// {\n//     fieldUUID: "xxx",\n//     taskUUIDs: ["aaa", "bbb", "ccc"]\n// }\n\n// Returned format:\n// {\n//     body:{\n//         code: 200,\n//         body: {\n//             values: [\n//                 {\n//                     taskUUID: "aaa",\n//                     value: 1.2\n//                 },\n//                 {\n//                     taskUUID: "bbb",\n//                     value: 2.3\n//                 },\n//             ]\n//         }\n//     }\n// }\nexport const calcFieldValues = async (request: PluginRequest): Promise<PluginResponse> => {\n  const body = request?.body as any\n  const returnValue: any[] = []\n\n  //Uuid array of task that require calculate\n  if (body.fieldUUID && body.taskUUIDs && body.taskUUIDs.length > 0) {\n    for (const taskUUID of body.taskUUIDs) {\n      returnValue.push({\n        taskUUID: taskUUID, //Please note that the script field already exists for the task\n        value: 200000, //The specific returned value can be counted according to the business logic.\n      })\n    }\n  }\n\n  return {\n    body: {\n      code: 200,\n      body: {\n        values: returnValue,\n      },\n    },\n  }\n}\n')))),(0,l.kt)("h3",{id:"step-2-modify-plugin-configuration-file"},"Step 2: Modify plugin configuration file"),(0,l.kt)("p",null,"Modify the corresponding content of the ability in the plugin configuration file, where ",(0,l.kt)("strong",{parentName:"p"},"abilities.config")," is the configuration of the script field ability, and the value of ",(0,l.kt)("strong",{parentName:"p"},"abilities.config.value"),' is the name of the script field,here it is changed to "scriptField1",The value of ',(0,l.kt)("strong",{parentName:"p"},"abilities.function.calcFieldValue"),' is the name of the script field calculation method, and here it is changed to "countFunc".'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="config/plugin.yaml"',title:'"config/plugin.yaml"'},"service:\n  app_id: ...\n  name: ability-scriptFloat\n  ...\napis:\n  ...\nabilities:\n  - id: ...\n    name: scriptField\n    version: 1.0.0\n    abilityType: ScriptFieldFloat\n    function:\n      calcFieldValue: countFunc\n    config:\n      - key: FieldName\n        value: scriptField1\n        fieldType: Input\n        show: false\n")),(0,l.kt)("h3",{id:"step-3-complete-the-script-field-calculation-rule"},"step 3: Complete the script field calculation rule"),(0,l.kt)("p",null,"Modify the script field method, which defaults to the ",(0,l.kt)("inlineCode",{parentName:"p"},"calcFieldValues")," method of ",(0,l.kt)("inlineCode",{parentName:"p"},"{{plugin root directory}}/backend/src/script-field-float.ts"),"."),(0,l.kt)("p",null,"The default implementation method is given here, which only follows the previous step and modifies the method name to ",(0,l.kt)("inlineCode",{parentName:"p"},"countFunc")),(0,l.kt)("admonition",{type:"info"},(0,l.kt)("p",{parentName:"admonition"},"Note that the value in the returned parameter ",(0,l.kt)("inlineCode",{parentName:"p"},"returnValue")," defaults to floating point, and its unit defaults to ",(0,l.kt)("inlineCode",{parentName:"p"},"1 / 100000"),". When the returned value is ",(0,l.kt)("strong",{parentName:"p"},"200000"),", the actual value is ",(0,l.kt)("strong",{parentName:"p"},"2"))),(0,l.kt)("h2",{id:"examples"},"Examples"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/docs/abilities/business/field/script-field-float/sample-script-field-float"},"Automatically count the number of relationships of a certain link type of issue"))),(0,l.kt)("h2",{id:"faq"},"FAQ"),(0,l.kt)("h5",{id:"what-if-you-want-to-create-multiple-script-fields"},"What if you want to create multiple script fields?"),(0,l.kt)("p",null,"The abilities in ",(0,l.kt)("inlineCode",{parentName:"p"},"plugin.yaml")," is an array.The ability can be used many times. Note that ",(0,l.kt)("inlineCode",{parentName:"p"},"id")," of ability should be different."),(0,l.kt)("h5",{id:"what-if-there-is-an-field-with-the-same-in-the-system"},"What if there is an field with the same in the system?"),(0,l.kt)("p",null,"There are two cases of field with the same name. If you have different issue types with the same name, enabling the plugin at this time will cause an error. It can be hosted if it has the same name and there is no plugin to host the field."))}g.isMDXComponent=!0}}]);