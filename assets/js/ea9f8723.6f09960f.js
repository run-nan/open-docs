(self.webpackChunkopen_docs=self.webpackChunkopen_docs||[]).push([[56464],{47223:(e,t,o)=>{e.exports={src:{srcSet:o.p+"assets/ideal-img/code-repo-connector-en.1724558.1024.png 1024w,"+o.p+"assets/ideal-img/code-repo-connector-en.a428da3.1461.png 1461w",images:[{path:o.p+"assets/ideal-img/code-repo-connector-en.1724558.1024.png",width:1024,height:531},{path:o.p+"assets/ideal-img/code-repo-connector-en.a428da3.1461.png",width:1461,height:758}],src:o.p+"assets/ideal-img/code-repo-connector-en.1724558.1024.png",toString:function(){return o.p+"assets/ideal-img/code-repo-connector-en.1724558.1024.png"},placeholder:void 0,width:1024,height:531},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAFCAYAAAB8ZH1oAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAkElEQVQImVXMSw6CMACE4d7ZGEuf3octJ3BTBQNqglEWnIIEVOpv6MLoJLP7ZsRGZuR5TlmWhBCoqoqiKNBaY63FOsdKWoSUGe3lxG/6vkcplaCxlnVmEMuyqWviPDMMAzFG2vaakPc+des9wmhFOJ55RZjGMT129xvGmC90zi1Qszs0PCM8ppE3sG/+Hxf4Ad1omJpqAYw1AAAAAElFTkSuQmCC"}},47192:(e,t,o)=>{e.exports={src:{srcSet:o.p+"assets/ideal-img/code-repo-github-add-repo-en.f3f3a35.577.png 577w",images:[{path:o.p+"assets/ideal-img/code-repo-github-add-repo-en.f3f3a35.577.png",width:577,height:389}],src:o.p+"assets/ideal-img/code-repo-github-add-repo-en.f3f3a35.577.png",toString:function(){return o.p+"assets/ideal-img/code-repo-github-add-repo-en.f3f3a35.577.png"},placeholder:void 0,width:577,height:389},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAHCAYAAAAxrNxjAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAo0lEQVQYlXWPTWpDMQyEff8r5RDZd9tNXB61n+1nRfLPF+wQ6KaCYYRm0Egu58RxHKgZ/1XvHXfWRimFnPPmv1iz67qYY+B+i/LjPY+HJ4SwxZQSZ0rEMyFPZcyJKzkTY9wQEeacwERscEonSadqx8UQ8N7vqGU0M1pr2IK13Y/RcUtcd6jqNi3+wEypotSn4T6frch3LHvLVSvThPt34fZVeQGHfBAd40rPDgAAAABJRU5ErkJggg=="}},91906:(e,t,o)=>{e.exports={src:{srcSet:o.p+"assets/ideal-img/code-repo-list-en.52292f9.1024.png 1024w,"+o.p+"assets/ideal-img/code-repo-list-en.629f3af.1467.png 1467w",images:[{path:o.p+"assets/ideal-img/code-repo-list-en.52292f9.1024.png",width:1024,height:294},{path:o.p+"assets/ideal-img/code-repo-list-en.629f3af.1467.png",width:1467,height:421}],src:o.p+"assets/ideal-img/code-repo-list-en.52292f9.1024.png",toString:function(){return o.p+"assets/ideal-img/code-repo-list-en.52292f9.1024.png"},placeholder:void 0,width:1024,height:294},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAADCAYAAACqPZ51AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAUElEQVQImVWMQQ6AMAjA9v+XmnibDhgwapwnD03aS5uoEhEbd//5Wkmu4uhB67cyzRhjoKqYGSKCyDfwSM7LaV0m7hM1o6rIzH2bHrtfoHgAM1d1iQTdyugAAAAASUVORK5CYII="}},40003:(e,t,o)=>{e.exports={src:{srcSet:o.p+"assets/ideal-img/code-repo-print-en.2878a86.1024.png 1024w,"+o.p+"assets/ideal-img/code-repo-print-en.64cb2e1.1697.png 1697w",images:[{path:o.p+"assets/ideal-img/code-repo-print-en.2878a86.1024.png",width:1024,height:183},{path:o.p+"assets/ideal-img/code-repo-print-en.64cb2e1.1697.png",width:1697,height:303}],src:o.p+"assets/ideal-img/code-repo-print-en.2878a86.1024.png",toString:function(){return o.p+"assets/ideal-img/code-repo-print-en.2878a86.1024.png"},placeholder:void 0,width:1024,height:183},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAACCAYAAABhYU3QAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAPUlEQVQImR3KSQoAMQwDwfz/t4MdR/KCBnyrhj5+Q+5XZiYAigeR0AMEch0ROl+kkL1Td2tmRHIbzHVV6Qd36E4SOM8SJgAAAABJRU5ErkJggg=="}},30346:(e,t,o)=>{e.exports={src:{srcSet:o.p+"assets/ideal-img/code-repo-print-overview-en.1b5b4f2.1024.png 1024w,"+o.p+"assets/ideal-img/code-repo-print-overview-en.5d0aaaa.1485.png 1485w",images:[{path:o.p+"assets/ideal-img/code-repo-print-overview-en.1b5b4f2.1024.png",width:1024,height:283},{path:o.p+"assets/ideal-img/code-repo-print-overview-en.5d0aaaa.1485.png",width:1485,height:411}],src:o.p+"assets/ideal-img/code-repo-print-overview-en.1b5b4f2.1024.png",toString:function(){return o.p+"assets/ideal-img/code-repo-print-overview-en.1b5b4f2.1024.png"},placeholder:void 0,width:1024,height:283},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAADCAYAAACqPZ51AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAU0lEQVQImW2KMQ7DMAzE/P8fFhkzZCqSIbUlnWQGztxbCBLX3J3MQhI/S/ZvwKy3eYjhSVXRlnQTfRjnHXwOY87CtY5Jt0QqWoTesHjdznYM/u0BMjt1ggTIg8wAAAAASUVORK5CYII="}},50995:(e,t,o)=>{e.exports={src:{srcSet:o.p+"assets/ideal-img/code-repo-task-en.fcadc73.1024.png 1024w,"+o.p+"assets/ideal-img/code-repo-task-en.4a6191b.1036.png 1036w",images:[{path:o.p+"assets/ideal-img/code-repo-task-en.fcadc73.1024.png",width:1024,height:600},{path:o.p+"assets/ideal-img/code-repo-task-en.4a6191b.1036.png",width:1036,height:607}],src:o.p+"assets/ideal-img/code-repo-task-en.fcadc73.1024.png",toString:function(){return o.p+"assets/ideal-img/code-repo-task-en.fcadc73.1024.png"},placeholder:void 0,width:1024,height:600},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAf0lEQVQImU2OAQ7FIAhDvf9ZtwyjggLSH92W/SYkQB60qRaCdMWcExEBM4PqgKru3t13JSLCQRW5VIgwWmPwcERgA+t4VSq1ws2wtBYzAqITag4WgY6x3dJ5EZh5Dy+83pl+cZbScV7IOX/Lx6qb4kbu49S4Q0R2nv+v9uR7wR8cAuvr8O9kVAAAAABJRU5ErkJggg=="}},38313:(e,t,o)=>{"use strict";o.r(t),o.d(t,{assets:()=>p,contentTitle:()=>r,default:()=>m,frontMatter:()=>s,metadata:()=>l,toc:()=>d});var i=o(87462),n=(o(67294),o(3905)),a=o(15944);const s={sidebar_position:6,description:"Operations related to third party code repository."},r="Integration code repository",l={unversionedId:"abilities/business/custom-code-repository/custom-code-repository",id:"abilities/business/custom-code-repository/custom-code-repository",title:"Integration code repository",description:"Operations related to third party code repository.",source:"@site/docs/abilities/business/custom-code-repository/custom-code-repository.mdx",sourceDirName:"abilities/business/custom-code-repository",slug:"/abilities/business/custom-code-repository/",permalink:"/open-docs/docs/next/abilities/business/custom-code-repository/",draft:!1,tags:[],version:"current",lastUpdatedBy:"liupengfei",lastUpdatedAt:1690862808,formattedLastUpdatedAt:"Aug 1, 2023",sidebarPosition:6,frontMatter:{sidebar_position:6,description:"Operations related to third party code repository."},sidebar:"abilities",previous:{title:"Scene\uff1aCustom sprint component with context-based permission",permalink:"/open-docs/docs/next/abilities/business/permission/custom-permission/permission-with-context"},next:{title:"Scene: Integrate the private Gitlab code repository of the specified version",permalink:"/open-docs/docs/next/abilities/business/custom-code-repository/custom-code-repository-private-gitlab"}},p={},d=[{value:"Requirements",id:"requirements",level:2},{value:"Overview",id:"overview",level:2},{value:"Ability performance",id:"ability-performance",level:3},{value:"Usage",id:"usage",level:2},{value:"Step 1: Ability configuration to add ability and module to the plugin",id:"step-1-ability-configuration-to-add-ability-and-module-to-the-plugin",level:3},{value:"1. Add abilities",id:"1-add-abilities",level:4},{value:"2. Add modules",id:"2-add-modules",level:4},{value:"3. Abilities Link Modules",id:"3-abilities-link-modules",level:4},{value:"step2: Custom code repository link page",id:"step2-custom-code-repository-link-page",level:3},{value:"step3: Add repositories",id:"step3-add-repositories",level:3},{value:"step4: add code repository commit and pull request",id:"step4-add-code-repository-commit-and-pull-request",level:3},{value:"Abilities in Different Life Cycle Stages",id:"abilities-in-different-life-cycle-stages",level:2},{value:"Examples",id:"examples",level:2}],c={toc:d};function m(e){let{components:t,...s}=e;return(0,n.kt)("wrapper",(0,i.Z)({},c,s,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"integration-code-repository"},"Integration code repository"),(0,n.kt)("h2",{id:"requirements"},"Requirements"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"ONES"),(0,n.kt)("th",{parentName:"tr",align:"left"},"@ones-op/node-ability"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"v3.13.9+"),(0,n.kt)("td",{parentName:"tr",align:"left"},"v0.4.0+")))),(0,n.kt)("h2",{id:"overview"},"Overview"),(0,n.kt)("p",null,'Open platform provides the ability "integration code repository", which can be used to associate the code commit and pull request of the integrated third-party code repository with the ONES Project issue. After the association is successful, after the team members complete the coding, enter the ID of the issue item involved in the Commit message when submitting the Commit, or enter the ID of the issue item involved in the Title when submitting the Pull Request. Separated by "space", you can view the code commit and code pull request in ONES in real time after submission.'),(0,n.kt)("h3",{id:"ability-performance"},"Ability performance"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'After using this capability, you can click "Link Repository" on the Configuration -> Pipeline settings -> Repository page to view the link code repository options added by the capability'),(0,n.kt)(a.Z,{img:o(47223),mdxType:"Image"})),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"After associating the code repository through the ability, you can associate the code repository with the built-in types such as GitHub, GitLab, private GitLab, SVN, and Private Bitbucket of the ONES system. After the association is successful, it will be the same as other built-in types in the code repository configuration face list display."),(0,n.kt)(a.Z,{img:o(91906),mdxType:"Image"})),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'After implementing the new code commit and new code pull request login through the ability, you can view the code association results in the "Code Association" column of the issue item details.'),(0,n.kt)(a.Z,{img:o(50995),mdxType:"Image"})),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Sprint supports summarizing the code submission data link with requirements, and the sprint leader can follow up the development progress based on this."),(0,n.kt)(a.Z,{img:o(40003),mdxType:"Image"})),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Under the sprint overview, the code submissions status of the current iteration will be summarized and counted to help the sprint leader evaluate the development contribution. Currently, it supports the statistics and analysis of the number of code submissions, the trend of the number of code commits, and the number of lines affected by code commits."),(0,n.kt)(a.Z,{img:o(30346),mdxType:"Image"}))),(0,n.kt)("h2",{id:"usage"},"Usage"),(0,n.kt)("h3",{id:"step-1-ability-configuration-to-add-ability-and-module-to-the-plugin"},"Step 1: Ability configuration to add ability and module to the plugin"),(0,n.kt)("h4",{id:"1-add-abilities"},"1. Add abilities"),(0,n.kt)("p",null,"Use the ",(0,n.kt)("inlineCode",{parentName:"p"},"OP")," command to add capabilities in the plugin project, select ",(0,n.kt)("inlineCode",{parentName:"p"},"custom-code-repository")," type:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"$ npx op add ability\n  \u2714 Validating the input params\n  \u2714 Validating project files exists\n  \u2714 Generating initial answers by input params\n  \u2714 Parsing plugin config content\n\nPre-require tasks run successfully\n? Please select the ability you want to add: \u2026 custom-code-repository\ncustom-code-repository@1.0.0\n")),(0,n.kt)("p",null,"The OP tool will ask whether to use the default value, select Yes, and the OP tool will add the following content to the plugin:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Add relevant paragraphs in the ",(0,n.kt)("inlineCode",{parentName:"p"},"abilities")," field of ",(0,n.kt)("inlineCode",{parentName:"p"},"config/plugin.yaml")," in the plugin project:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-yaml"},"service:\n  app_id: ...\n  name: ability-CustomCodeRepository\n  ...\napis:\n  ...\nabilities:\n  - id: CkrqExqC\n    name: CustomCodeRepository\n    version: 1.0.0\n    abilityType: CustomCodeRepository\n    relateModule:\n      addRepoPage: ''\n    function:\n      removeRepoFunc: removeRepo\n    config:\n      - key: repoToolName\n        label: Associated repository tool name\n        value: Custom code warehouse type\n        fieldType: Input\n        show: true\n      - key: repoToolDesc\n        label: Associated code repository tool description\n        value: Custom code warehouse type\n        fieldType: Input\n        show: true\n      - key: repoToolIcon\n        label: Link code repository tool icon\n        value: logo.svg\n        fieldType: Input\n        show: false\n")),(0,n.kt)("p",{parentName:"li"},"Among them, the three configurations in abilities.config are mainly used in Configuration -> Pipeline settings -> Repository -> link Code repository page to display the custom code repository link tool configuration, as shown in the following table:"))),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},(0,n.kt)("strong",{parentName:"th"},"Configuration item")),(0,n.kt)("th",{parentName:"tr",align:"left"},(0,n.kt)("strong",{parentName:"th"},"Description")))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"repoToolName"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Custom link code repository tool name (required, max length 128)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"repoToolDesc"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Custom link code repository tool description (required)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"repoToolIcon"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Custom link code repository tool name (required, max length 255) ",(0,n.kt)("br",null),"Rule: logo.svg corresponds to the web/public/logo.svg file in the plugin project")))),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Add a ",(0,n.kt)("inlineCode",{parentName:"p"},"custom-code-repository.ts")," file in the ",(0,n.kt)("inlineCode",{parentName:"p"},"backend/src")," directory of the plugin project."),(0,n.kt)("p",{parentName:"li"},"The file includes a default ",(0,n.kt)("inlineCode",{parentName:"p"},"removeRepo"),' method implementation, which will be called when the administrator does the "unlink" operation on the repository configuration page. The main purpose of providing this method is to allow the plugin to receive notifications that the code repository is unlink. Developers can keep it unchanged, or modify this method to do custom cleanup logic (the return value of the method will not affect the system to remove the link code repository).'))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-typescript"},"import { PluginRequest, PluginResponse } from '@ones-op/node-types'\n\nexport async function removeRepo(request: PluginRequest): Promise<PluginResponse> {\n  const body = request?.body as any\n  if (body && body.data) {\n    const repoInfo = body.data\n  }\n  return {\n    body: {\n      code: 200,\n    },\n  }\n}\n")),(0,n.kt)("h4",{id:"2-add-modules"},"2. Add modules"),(0,n.kt)("p",null,"Use the ",(0,n.kt)("inlineCode",{parentName:"p"},"OP")," command to add modules in the plugin project, select ",(0,n.kt)("a",{parentName:"p",href:"/open-docs/docs/next/abilities/slot/module/configuration/code-integration/default/code-repository/#onessettingspipelinedefaultrepolink"},"ones:settings:pipeline:default:repo:link")," type:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"$ npx op add module\n  \u2714 Validating the input params\n  \u2714 Validating project files exists\n  \u2714 Generating initial answers by input params\n  \u2714 Parsing plugin config content\n\nPre-require tasks run successfully\n? Please select the module type you want to add: \u2026 ones:settings:pipeline:default:repo:link\nones:settings:pipeline:default:repo:link\n")),(0,n.kt)("h4",{id:"3-abilities-link-modules"},"3. Abilities Link Modules"),(0,n.kt)("p",null,"In the ",(0,n.kt)("inlineCode",{parentName:"p"},"plugin.yaml")," file, associate the ability with the module, that is, configure the ",(0,n.kt)("inlineCode",{parentName:"p"},"id")," of the module to the ",(0,n.kt)("inlineCode",{parentName:"p"},"addRepoPage")," value of the ability configuration, and the final effect is as follows:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yaml"},"service:\n  app_id: ...\n  name: ability-CustomCodeRepository\n  ...\napis:\n  ...\nabilities:\n  - id: CkrqExqC\n    name: CustomCodeRepository\n    version: 1.0.0\n    abilityType: CustomCodeRepository\n    relateModule:\n      addRepoPage: 'ones-settings-pipeline-default-repo-link-R5w-'\n    function:\n      removeRepoFunc: removeRepo\n    config:\n      - key: repoToolName\n        label: the name of the associated code warehouse tool\n        value: custom associated code warehouse tool\n        fieldType: Input\n        show: true\n      - key: repoToolDesc\n        label: Associated code repository tool description\n        value: Custom associated code warehouse tool\n        fieldType: Input\n        show: true\n      - key: repoToolIcon\n        label: Link code repository tool icon\n        value: logo.svg\n        fieldType: Input\n        show: false\nmodules:\n  - id: ones-settings-pipeline-default-repo-link-R5w-\n    title: linkRepository\n    moduleType: ones:settings:pipeline:default:repo:link\n    entry: modules/ones-settings-pipeline-default-repo-link-R5w-/index.html\n")),(0,n.kt)("h3",{id:"step2-custom-code-repository-link-page"},"step2: Custom code repository link page"),(0,n.kt)("p",null,'Different from the built-in linked code repository method of the ONES system, click "Link Code repository" and there will be a default pop-up window page for adding linked code repository in the next step, as shown in the following figure for the associated code repository page of the Github method:'),(0,n.kt)("p",null,'Different from the built-in link code repository type of the ONES system, click "Link Repository" and there will be a default popup window page for adding code repository in the next step, as shown in the following figure for the link code repository page of the Github type:'),(0,n.kt)(a.Z,{img:o(47192),style:{maxWidth:600},mdxType:"Image"}),(0,n.kt)("p",null,"Developers need to customize the logic of the link code repository page in the module ",(0,n.kt)("inlineCode",{parentName:"p"},"ones-settings-pipeline-default-repo-link-R5w-"),' to realize the functions of "authentication of code repository platform" and "link code repository". The "authentication of the code repository platform" can be OAuth, Token, account password or other forms, or no authentication, and the developer can decide according to the situation.'),(0,n.kt)("admonition",{title:"notice",type:"caution"},(0,n.kt)("p",{parentName:"admonition"},'This page is linked with the prompt copy of the success or failure of the code repository, which needs to be implemented by the developer. The successfully linked code repository will be displayed on the code repository management page. At this time, different from the code repository linked with the built-in type, the "View Details" button will be displayed for the plugin associated.')),(0,n.kt)("h3",{id:"step3-add-repositories"},"step3: Add repositories"),(0,n.kt)("p",null,"In order to be able to add the code repositories to the ONES system, we provide the ",(0,n.kt)("a",{parentName:"p",href:"/open-docs/docs/next/reference/packages/node-ability/#addrepos"},"add code repositories")," method in the SDK method, which can be used as follows:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-typescript"},"import { addRepos } from '@ones-op/node-ability'\n\nconst toolUUID: string = 'xxx'\nconst list: AddRepoInfo[] = [...]\nconst batchResponse = await addRepos(toolUUID, list)\n")),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"toolUUID")," field corresponds to the UUID unique identifier of the custom code repository type in the ONES system, which can be obtained by defining the following method, where ",(0,n.kt)("inlineCode",{parentName:"p"},"CkrqExqC")," corresponds to the capability ID in the ",(0,n.kt)("inlineCode",{parentName:"p"},"plugin.yaml")," file:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-typescript"},"import { getAbilityProperties } from '@ones-op/node-ability'\n\nexport async function getRepoToolUUID(): Promise<string> {\n  const repoToolUUIDKey = 'repoToolUUID'\n  const abilityID = 'CkrqExqC'\n\n  let repoToolUUID = ''\n  const property = await getAbilityProperties(abilityID, [repoToolUUIDKey])\n  if (property?.repoToolUUID) {\n    repoToolUUID = property[repoToolUUIDKey]\n  }\n  return repoToolUUID\n}\n")),(0,n.kt)("admonition",{title:"notice",type:"caution"},(0,n.kt)("p",{parentName:"admonition"},"When calling the ",(0,n.kt)("inlineCode",{parentName:"p"},"getAbilityProperties")," method for a team-level plugin, ",(0,n.kt)("inlineCode",{parentName:"p"},"teamUUID")," can be omitted, and when calling for an organization-level plugin, ",(0,n.kt)("inlineCode",{parentName:"p"},"teamUUID")," must be passed.")),(0,n.kt)("h3",{id:"step4-add-code-repository-commit-and-pull-request"},"step4: add code repository commit and pull request"),(0,n.kt)("p",null,"After successfully link the code repository, you can call the SDK methods ",(0,n.kt)("a",{parentName:"p",href:"/open-docs/docs/next/reference/packages/node-ability/#addrepocommits"},"add repository commits")," and ",(0,n.kt)("a",{parentName:"p",href:"/open-docs/docs/next/reference/packages/node-ability/#addrepopullrequest"},"add repository pull request")," to the ONES system."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"add commits:")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-typescript"},"import { addRepoCommits } from '@ones-op/node-ability'\n\nconst toolUUID: string = 'xxx'\nconst repoUUID: string = 'xxx'\nconst list: AddRepoInfo[] = [...]\nawait addRepoCommits(toolUUID, repoUUID, list)\n")),(0,n.kt)("ol",{start:2},(0,n.kt)("li",{parentName:"ol"},"add pull request (support for add and update)")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-typescript"},"import { addRepoPullRequest } from '@ones-op/node-ability'\n\nconst toolUUID: string = 'xxx'\nconst repoUUID: string = 'xxx'\nconst pullRequest: RepoPullRequest = '{...}'\nawait addRepoPullRequest(toolUUID, repoUUID, pullRequest)\n")),(0,n.kt)("p",null,"In order to facilitate the query of linked code repositories information, we provide the two SDK methods ",(0,n.kt)("a",{parentName:"p",href:"/open-docs/docs/next/reference/packages/node-ability/#queryrepo"},"query linked single code repository")," and ",(0,n.kt)("a",{parentName:"p",href:"/open-docs/docs/next/reference/packages/node-ability/#queryrepos"},"query all linked code repositories"),":"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"query linked single code repository")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-typescript"},"import { queryRepo } from '@ones-op/node-ability'\n\nconst toolUUID = 'xxx'\nconst uri = 'xxx'\nconst namespace = 'xxx'\nconst name = 'xxx'\nconst repoInfo = await queryRepo(toolUUID, uri, namespace, name)\n")),(0,n.kt)("ol",{start:2},(0,n.kt)("li",{parentName:"ol"},"query all linked code repositories")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-typescript"},"import { queryRepos } from '@ones-op/node-ability'\n\nconst toolUUID = 'xxx'\nconst repoInfos = await queryRepos(toolUUID)\n")),(0,n.kt)("h2",{id:"abilities-in-different-life-cycle-stages"},"Abilities in Different Life Cycle Stages"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Plugin enabled")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"On the option list page of the link repository type, the link type of ability definition is added;"),(0,n.kt)("li",{parentName:"ul"},"The link type defined by the ability, the link page of the ability definition will pop up in the next step, and the code repository can be linked through this page;"),(0,n.kt)("li",{parentName:"ul"},"After the code repository is successfully linked through the link type defined by the capability, it can be viewed on the code repository management page."),(0,n.kt)("li",{parentName:"ul"},"Through the ability to add the commit and pull request data of the code repository, after the associated work item is successfully displayed under the project. \u3002")),(0,n.kt)("ol",{start:2},(0,n.kt)("li",{parentName:"ol"},"Plugin disabled")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"On the option list page of the link repository type, the link type defined by the ability will be hidden, and it will be restored next time it is enabled;"),(0,n.kt)("li",{parentName:"ul"},"The code repository linked with the ability will be hidden on the code repository management page, and it will be restored next time it is enabled;"),(0,n.kt)("li",{parentName:"ul"},"Through the ability to add the commit and pull request data of the code repository, after the associated work item is successfully displayed under the project, it will not be hidden;"),(0,n.kt)("li",{parentName:"ul"},"At this time, an error will be reported when calling the SDK method provided by the capability. Pay attention to catching errors or distinguishing between plugin state processing.")),(0,n.kt)("ol",{start:3},(0,n.kt)("li",{parentName:"ol"},"plugin Uninstalled")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"On the option list page of the link repository type, the link type defined by the ability is deleted, and the next installation cannot be restored;"),(0,n.kt)("li",{parentName:"ul"},"The code repository linked with the ability is deleted on the code repository management page, and the next installation cannot be restored;"),(0,n.kt)("li",{parentName:"ul"},"Through the ability to add the commit and pull request data of the code repository, after the associated work item is successfully displayed under the project, it will not be deleted."),(0,n.kt)("li",{parentName:"ul"},"At this time, an error will be reported when calling the SDK method provided by the capability. Pay attention to catching errors or distinguishing between plugin state processing.")),(0,n.kt)("h2",{id:"examples"},"Examples"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"./custom-code-repository-private-gitlab"},"Scene: Integrate the private Gitlab code repository of the specified version"))))}m.isMDXComponent=!0}}]);