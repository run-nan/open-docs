(self.webpackChunkopen_docs=self.webpackChunkopen_docs||[]).push([[9478],{9778:(t,e,a)=>{t.exports={src:{srcSet:a.p+"assets/ideal-img/custom-permission01.1e6cefc.1024.png 1024w,"+a.p+"assets/ideal-img/custom-permission01.cdeb8a7.1720.png 1720w",images:[{path:a.p+"assets/ideal-img/custom-permission01.1e6cefc.1024.png",width:1024,height:505},{path:a.p+"assets/ideal-img/custom-permission01.cdeb8a7.1720.png",width:1720,height:848}],src:a.p+"assets/ideal-img/custom-permission01.1e6cefc.1024.png",toString:function(){return a.p+"assets/ideal-img/custom-permission01.1e6cefc.1024.png"},placeholder:void 0,width:1024,height:505},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAFCAYAAAB8ZH1oAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAYElEQVQImX2NSwqAMAxEc/+LqqjFTzVNSTqSoAtdGHiEgccM5XyAuSAfDFWFtQazLwaa04Jtz4GIhKxqULMQHM80TQlSK1o0WfwvvkL9MKNIxd+5TN244mS5J3z2zdN6Aaj1xMXLrOT6AAAAAElFTkSuQmCC"}},17942:(t,e,a)=>{"use strict";a.d(e,{Zo:()=>m,kt:()=>g});var n=a(50959);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function p(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},i=Object.keys(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var s=n.createContext({}),o=function(t){var e=n.useContext(s),a=e;return t&&(a="function"==typeof t?t(e):l(l({},e),t)),a},m=function(t){var e=o(t.components);return n.createElement(s.Provider,{value:e},t.children)},d="mdxType",k={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},u=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,i=t.originalType,s=t.parentName,m=p(t,["components","mdxType","originalType","parentName"]),d=o(a),u=r,g=d["".concat(s,".").concat(u)]||d[u]||k[u]||i;return a?n.createElement(g,l(l({ref:e},m),{},{components:a})):n.createElement(g,l({ref:e},m))}));function g(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var i=a.length,l=new Array(i);l[0]=u;var p={};for(var s in e)hasOwnProperty.call(e,s)&&(p[s]=e[s]);p.originalType=t,p[d]="string"==typeof t?t:r,l[1]=p;for(var o=2;o<i;o++)l[o]=a[o];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},21860:(t,e,a)=>{"use strict";a.r(e),a.d(e,{assets:()=>o,contentTitle:()=>p,default:()=>f,frontMatter:()=>l,metadata:()=>s,toc:()=>m});var n=a(28957),r=(a(50959),a(17942)),i=a(49500);const l={sidebar_position:17,toc_max_heading_level:4,description:'The ability allows for access restriction to customize plugin content. For example, when the frontend of a plugin needs to implement "level"-based pages, where different users (groups) have different access ranges, this ability can be used for permission control.'},p="Custom permission",s={unversionedId:"abilities/basic/custom-permission/custom-permission",id:"abilities/basic/custom-permission/custom-permission",title:"Custom permission",description:'The ability allows for access restriction to customize plugin content. For example, when the frontend of a plugin needs to implement "level"-based pages, where different users (groups) have different access ranges, this ability can be used for permission control.',source:"@site/docs/abilities/basic/custom-permission/custom-permission.mdx",sourceDirName:"abilities/basic/custom-permission",slug:"/abilities/basic/custom-permission/",permalink:"/open-docs/docs/abilities/basic/custom-permission/",draft:!1,tags:[],version:"current",lastUpdatedBy:"liupengfei",lastUpdatedAt:1703230356,formattedLastUpdatedAt:"Dec 22, 2023",sidebarPosition:17,frontMatter:{sidebar_position:17,toc_max_heading_level:4,description:'The ability allows for access restriction to customize plugin content. For example, when the frontend of a plugin needs to implement "level"-based pages, where different users (groups) have different access ranges, this ability can be used for permission control.'},sidebar:"abilities",previous:{title:"Full Screen",permalink:"/open-docs/docs/abilities/basic/full-screen"},next:{title:"Scene: System side component",permalink:"/open-docs/docs/abilities/basic/custom-permission/system-sider-permission"}},o={},m=[{value:"Requirements",id:"requirements",level:2},{value:"Overview",id:"overview",level:2},{value:"Performance",id:"performance",level:3},{value:"Usage",id:"usage",level:2},{value:"Custom standard permission configuration",id:"custom-standard-permission-configuration",level:3},{value:"Custom Permission API - BackEnd",id:"custom-permission-api---backend",level:3},{value:"Add permission point",id:"add-permission-point",level:4},{value:"Get permission point",id:"get-permission-point",level:4},{value:"permission",id:"permission",level:5},{value:"rule",id:"rule",level:5},{value:"Delete permission point",id:"delete-permission-point",level:4},{value:"Add permission rule",id:"add-permission-rule",level:4},{value:"Delete permission rule",id:"delete-permission-rule",level:4},{value:"Check permission point",id:"check-permission-point",level:4},{value:"Batch permission point check",id:"batch-permission-point-check",level:4},{value:"Custom Permission Point API - Front End",id:"custom-permission-point-api---front-end",level:3},{value:"Get permission points info",id:"get-permission-points-info",level:4},{value:"URL",id:"url",level:5},{value:"HTTP Method",id:"http-method",level:5},{value:"Transfer method",id:"transfer-method",level:5},{value:"List of request parameters",id:"list-of-request-parameters",level:5},{value:"Returns a list of parameters",id:"returns-a-list-of-parameters",level:5},{value:"Example of request",id:"example-of-request",level:5},{value:"Return Example",id:"return-example",level:5},{value:"Check permission point",id:"check-permission-point-1",level:4},{value:"URL",id:"url-1",level:5},{value:"HTTP Method",id:"http-method-1",level:5},{value:"Transfer method",id:"transfer-method-1",level:5},{value:"List of request param",id:"list-of-request-param",level:5},{value:"Returns a list of parameters",id:"returns-a-list-of-parameters-1",level:5},{value:"Example of request",id:"example-of-request-1",level:5},{value:"Return Example",id:"return-example-1",level:5},{value:"Custom permission ability",id:"custom-permission-ability",level:3},{value:"Step 1: Add configuration",id:"step-1-add-configuration",level:4},{value:"Step 2: Write permission verification function",id:"step-2-write-permission-verification-function",level:4},{value:"Examples",id:"examples",level:2}],d=(k="Image",function(t){return i.warn("Component "+k+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)});var k;const u={toc:m},g="wrapper";function f(t){let{components:e,...i}=t;return(0,r.kt)(g,(0,n.Z)({},u,i,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"custom-permission"},"Custom permission"),(0,r.kt)("h2",{id:"requirements"},"Requirements"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"ONES"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"v3.10.14+")))),(0,r.kt)("h2",{id:"overview"},"Overview"),(0,r.kt)("p",null,'Sometimes the content customized by the plugin also needs to control access permissions, and only relying on the existing permission verification of ONES cannot satisfy the permission control of the customized content of the plugin. Therefore, we provide the custom permission ability, which can be used to restrict access to the custom content of the plugin. For example: when the front end of the plugin needs to implement "level" pages, and different users (groups) have different access scopes, this ability can be used for permission control.'),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"The permission added with this ability only take effect within the plugin, that is, it can only control the access rights of the content added by the plugin.")),(0,r.kt)("h3",{id:"performance"},"Performance"),(0,r.kt)("p",null,"After using the ability to add permissions, there are related permission configurations on the permission configuration page of the plugin details."),(0,r.kt)(d,{img:a(9778),mdxType:"Image"}),(0,r.kt)("h2",{id:"usage"},"Usage"),(0,r.kt)("p",null,"The custom permission ability supports the use of custom permission points in three ways: ",(0,r.kt)("strong",{parentName:"p"},"customized standard permission configuration"),", ",(0,r.kt)("strong",{parentName:"p"},"custom permission API")," and ",(0,r.kt)("strong",{parentName:"p"},"custom permission point ability"),". Currently, custom permission points can only be used with front-end slots. For specific usage methods, please refer to: ",(0,r.kt)("a",{parentName:"p",href:"../../../reference/config/plugin.yaml#modulePermission"},"permission")),(0,r.kt)("admonition",{title:"NOTICE",type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Only the permission points added through the ability can be customized by the plugin to verify the logic of the permission, and the others use the original permission verification logic of ONES.")),(0,r.kt)("h3",{id:"custom-standard-permission-configuration"},"Custom standard permission configuration"),(0,r.kt)("p",null,"Add a custom array of standard permission point configuration items in the plugin's configuration file"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Param:")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Default"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"name"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission name"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y"),(0,r.kt)("td",{parentName:"tr",align:"left"},"-")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"field"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission unique identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y"),(0,r.kt)("td",{parentName:"tr",align:"left"},"-")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"desc"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission description"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"N"),(0,r.kt)("td",{parentName:"tr",align:"left"},"-")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="config/plugin.yaml"',title:'"config/plugin.yaml"'},"service:\n  permission:\n    - name: My custom read permission\n      field: my-custom-read-permission-key\n      desc: This is an example of custom read permission\n")),(0,r.kt)("h3",{id:"custom-permission-api---backend"},"Custom Permission API - BackEnd"),(0,r.kt)("p",null,"Provides non-declarative permission point definition and configuration methods, these APIs can be used in the plugin backend to manage custom permissions."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"In the examples, the ",(0,r.kt)("inlineCode",{parentName:"p"},"addition")," interface is added through the ",(0,r.kt)("a",{parentName:"p",href:"/open-docs/docs/abilities/basic/ones-api/registration"},"ONES API registration")," ability for debugging")),(0,r.kt)("h4",{id:"add-permission-point"},"Add permission point"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Param:")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"path"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Routing, fixed value: ",(0,r.kt)("inlineCode",{parentName:"td"},"AddPermissionInfo")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"headers"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request header, fixed value:",(0,r.kt)("br",null),"{",(0,r.kt)("br",null),' "AbilityName":','["AddPermissionInfo"]',(0,r.kt)("br",null)," }"),(0,r.kt)("td",{parentName:"tr",align:"left"},"any"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request method, fixed value:",(0,r.kt)("inlineCode",{parentName:"td"},"POST")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"body"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The request body contains permission point information."),(0,r.kt)("td",{parentName:"tr",align:"left"},"any"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"body")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_name"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission point name"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_field"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission unique identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_desc"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission point description"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Return:")," Contents in ",(0,r.kt)("inlineCode",{parentName:"p"},"response.body['data']")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Normal")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"organization_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"organization uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"team_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"team uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"instance_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"plugin instance id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_name"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission point name"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_desc"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission point description"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_field"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission unique identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission point id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"check_mode"),(0,r.kt)("td",{parentName:"tr",align:"left"},"check type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"ability_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"ability id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Error")),(0,r.kt)("p",null,"Return when the added permission point already exists: permission_field of plugin already exists"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"export async function addPermission(request: PluginRequest): Promise<PluginResponse> {\n  const response = await fetchONES({\n    path: `AddPermissionInfo`,\n    headers: {\n      AbilityName: ['AddPermissionInfo'],\n    },\n    method: 'POST',\n    body: {\n      permission_name: 'api_add_permission', // permission point name\n      permission_field: 'api_add_permission123', // permission unique identifier\n      permission_desc: 'test',\n    },\n  })\n  const body = response?.body as any\n  const data = JSON.parse(body.toString())['data']\n  Logger.info(data)\n  return {\n    body: {\n      data: data,\n    },\n  }\n}\n")),(0,r.kt)("h4",{id:"get-permission-point"},"Get permission point"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Param:")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"path"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Routing, fixed value: ",(0,r.kt)("inlineCode",{parentName:"td"},"PermissionInfoList")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"headers"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request header, fixed value:",(0,r.kt)("br",null),"{",(0,r.kt)("br",null),' "AbilityName":','["PermissionInfoList"]',(0,r.kt)("br",null)," }"),(0,r.kt)("td",{parentName:"tr",align:"left"},"any"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request method, fixed value:",(0,r.kt)("inlineCode",{parentName:"td"},"POST")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Return:")," Contents in ",(0,r.kt)("inlineCode",{parentName:"p"},"response.body['data']"),", contains an array of permission point information, and each permission point contains the following content"),(0,r.kt)("h5",{id:"permission"},"permission"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"instance_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"plugin instance id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_name"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission point name"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_desc"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission point description"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_field"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission unique identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission point id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"check_mode"),(0,r.kt)("td",{parentName:"tr",align:"left"},"check type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"rule_info"),(0,r.kt)("td",{parentName:"tr",align:"left"},"information about configured rules"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("a",{parentName:"td",href:"#rule"},"rule"),"[]")))),(0,r.kt)("h5",{id:"rule"},"rule"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission rule id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission point id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"context_type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"context type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"context_param_1"),(0,r.kt)("td",{parentName:"tr",align:"left"},"context param 1"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"context_param_2"),(0,r.kt)("td",{parentName:"tr",align:"left"},"context param 2"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"user_domain_type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"user domain type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"user_domain_param"),(0,r.kt)("td",{parentName:"tr",align:"left"},"user domain param"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"position"),(0,r.kt)("td",{parentName:"tr",align:"left"},"location"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"export async function listPermission(request: PluginRequest): Promise<PluginResponse> {\n  const response = await fetchONES({\n    path: `PermissionInfoList`,\n    headers: {\n      AbilityName: ['PermissionInfoList'],\n    },\n    method: 'POST',\n    body: {},\n  })\n  const body = response?.body as any\n  const data = JSON.parse(body.toString())['data']\n  Logger.info(data)\n  return {\n    body: {\n      data: data,\n    },\n  }\n}\n")),(0,r.kt)("h4",{id:"delete-permission-point"},"Delete permission point"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Param:")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"path"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Routing, fixed value: ",(0,r.kt)("inlineCode",{parentName:"td"},"DeletePermissionInfo")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"headers"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request header, fixed value:",(0,r.kt)("br",null),"{",(0,r.kt)("br",null),' "AbilityName":','["DeletePermissionInfo"]',(0,r.kt)("br",null)," }"),(0,r.kt)("td",{parentName:"tr",align:"left"},"any"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request method, fixed value:",(0,r.kt)("inlineCode",{parentName:"td"},"POST")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"body"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request body, including permission unique identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"any"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"body")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_field"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission unique identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"export async function deletePermission(request: PluginRequest): Promise<PluginResponse> {\n  const response = await fetchONES({\n    path: `DeletePermissionInfo`,\n    headers: {\n      AbilityName: ['DeletePermissionInfo'],\n    },\n    method: 'POST',\n    body: {\n      permission_field: 'api_add_permission123',\n    },\n  })\n  const body = response?.body as any\n  const data = JSON.parse(body.toString())['data']\n  Logger.info(data)\n  return {\n    body: {\n      data: data,\n    },\n  }\n}\n")),(0,r.kt)("h4",{id:"add-permission-rule"},"Add permission rule"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Param:")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"path"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Routing, fixed value: ",(0,r.kt)("inlineCode",{parentName:"td"},"AddPermissionRule")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"headers"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request header, fixed value:",(0,r.kt)("br",null),"{",(0,r.kt)("br",null),' "AbilityName":','["AddPermissionRule"]',(0,r.kt)("br",null)," }"),(0,r.kt)("td",{parentName:"tr",align:"left"},"any"),(0,r.kt)("td",{parentName:"tr",align:null},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request method, fixed value:",(0,r.kt)("inlineCode",{parentName:"td"},"POST")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"body"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request body, including permission point rule information"),(0,r.kt)("td",{parentName:"tr",align:"left"},"any"),(0,r.kt)("td",{parentName:"tr",align:null},"Y")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"body")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission point id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"user_domain_type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"User domain type, optional values:",(0,r.kt)("br",null),"Everyone-",(0,r.kt)("inlineCode",{parentName:"td"},"everyone"),(0,r.kt)("br",null),"User-",(0,r.kt)("inlineCode",{parentName:"td"},"single_user"),(0,r.kt)("br",null),"Department-",(0,r.kt)("inlineCode",{parentName:"td"},"department"),(0,r.kt)("br",null),"User group-",(0,r.kt)("inlineCode",{parentName:"td"},"group"),(0,r.kt)("br",null)," Team Owner - ",(0,r.kt)("inlineCode",{parentName:"td"},"team_owner")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"user_domain_param"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The unique identifier of the user domain, for example, when the user domain is ",(0,r.kt)("inlineCode",{parentName:"td"},"single_user"),", the value of this parameter indicates ",(0,r.kt)("inlineCode",{parentName:"td"},"user_uuid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Return:")," Contents in ",(0,r.kt)("inlineCode",{parentName:"p"},"response.body['data']")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Normal")),(0,r.kt)("p",null,"Contains information about adding permission rules this time"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"org_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"organization uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"team_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"team uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission rule id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"deleted"),(0,r.kt)("td",{parentName:"tr",align:"left"},"delete or not"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Bool")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission point id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"context_type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"context type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"context_param_1"),(0,r.kt)("td",{parentName:"tr",align:"left"},"context param 1"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"context_param_2"),(0,r.kt)("td",{parentName:"tr",align:"left"},"context param 2"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"user_domain_type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"user domain type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"user_domain_param"),(0,r.kt)("td",{parentName:"tr",align:"left"},"user domain param"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"position"),(0,r.kt)("td",{parentName:"tr",align:"left"},"location"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Error")),(0,r.kt)("p",null,"When the user domain type of the added permission point rule is wrong, return: ",(0,r.kt)("inlineCode",{parentName:"p"},"<UserDomainNotExist> UserDomainNotExist")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"export async function addRule(request: PluginRequest): Promise<PluginResponse> {\n  const { user_uuid, permission_id } = request.body as any\n  const response = await fetchONES({\n    path: `AddPermissionRule`,\n    headers: {\n      AbilityName: ['AddPermissionRule'],\n    },\n    method: 'POST',\n    body: {\n      permission_id: permission_id, // The unique id of permission, returned when add_permission_info\n      user_domain_type: 'single_user', // User domain type, existing: everyone, single_user, department, group, team_owner\n      user_domain_param: user_uuid, // The unique identifier of the user domain, for example, when user_domain_type is single_user, user_domain_param is the identifier of user_uuid\n    },\n  })\n  const body = response?.body as any\n  const data = JSON.parse(body.toString())['data']\n  Logger.info(data)\n  return {\n    body: {\n      data: data,\n    },\n  }\n}\n")),(0,r.kt)("h4",{id:"delete-permission-rule"},"Delete permission rule"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Param:")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"path"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Routing, fixed value: ",(0,r.kt)("inlineCode",{parentName:"td"},"DeletePermissionRule")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"headers"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request header, fixed value:",(0,r.kt)("br",null),"{",(0,r.kt)("br",null),' "AbilityName":','["DeletePermissionRule"]',(0,r.kt)("br",null)," }"),(0,r.kt)("td",{parentName:"tr",align:"left"},"any"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request method, fixed value:",(0,r.kt)("inlineCode",{parentName:"td"},"POST")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"body"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request body, including the unique identifier of the permission rule"),(0,r.kt)("td",{parentName:"tr",align:"left"},"any"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"body")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission rule id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"export async function deleteR(request: PluginRequest): Promise<PluginResponse> {\n  const { rule_id, user_uuid } = request.body as any\n  const response = await fetchONES({\n    path: `DeletePermissionRule`,\n    headers: {\n      AbilityName: ['DeletePermissionRule'],\n    },\n    method: 'POST',\n    body: {\n      id: rule_id, // The unique id of permission_rule will be returned when add_permission_rule\n    },\n  })\n  const body = response?.body as any\n  const data = JSON.parse(body.toString())['data']\n  Logger.info(data)\n  return {\n    body: {\n      data: data,\n    },\n  }\n}\n")),(0,r.kt)("h4",{id:"check-permission-point"},"Check permission point"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Param:")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"path"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Routing, fixed value: ",(0,r.kt)("inlineCode",{parentName:"td"},"CheckPermissionRule")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"headers"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request header, fixed value:",(0,r.kt)("br",null),"{",(0,r.kt)("br",null),' "AbilityName":','["CheckPermissionRule"]',(0,r.kt)("br",null)," }"),(0,r.kt)("td",{parentName:"tr",align:"left"},"any"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request method, fixed value:",(0,r.kt)("inlineCode",{parentName:"td"},"POST")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"body"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request body, containing information about inspection"),(0,r.kt)("td",{parentName:"tr",align:"left"},"any"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"body")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_field"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission unique identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"user_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"User's ",(0,r.kt)("inlineCode",{parentName:"td"},"uuid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Return:")," Contents in ",(0,r.kt)("inlineCode",{parentName:"p"},"response.body['data']")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"is_permission"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Is there permission"),(0,r.kt)("td",{parentName:"tr",align:"left"},"bool")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"export async function checkPermission(request: PluginRequest): Promise<PluginResponse> {\n  const { user_uuid, permission_field } = request.body as any\n  const response = await fetchONES({\n    path: `CheckPermissionRule`,\n    headers: {\n      AbilityName: ['CheckPermissionRule'],\n    },\n    method: 'POST',\n    body: {\n      permission_field: permission_field,\n      user_uuid: user_uuid,\n    },\n  })\n  const body = response?.body as any\n  const data = JSON.parse(body.toString())['data']\n  Logger.info(data)\n  return {\n    body: {\n      data: data,\n    },\n  }\n}\n")),(0,r.kt)("h4",{id:"batch-permission-point-check"},"Batch permission point check"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Param:")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"path"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Routing, fixed value: ",(0,r.kt)("inlineCode",{parentName:"td"},"BatchCheckPermission")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"headers"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request header, fixed value:",(0,r.kt)("br",null),"{",(0,r.kt)("br",null),' "AbilityName":','["BatchCheckPermission"]',(0,r.kt)("br",null)," }"),(0,r.kt)("td",{parentName:"tr",align:"left"},"any"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request method, fixed value:",(0,r.kt)("inlineCode",{parentName:"td"},"POST")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"body"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Request body, including all verification information"),(0,r.kt)("td",{parentName:"tr",align:"left"},"any"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"body")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"organization_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"organization uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_field"),(0,r.kt)("td",{parentName:"tr",align:"left"},"unique ID of the permission"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"team_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"team uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"instance_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"plugin instance id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"user_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"User's ",(0,r.kt)("inlineCode",{parentName:"td"},"uuid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Return:")," Contents in ",(0,r.kt)("inlineCode",{parentName:"p"},"response.body['data']")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"is_permission"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The result of each permission check"),(0,r.kt)("td",{parentName:"tr",align:"left"},"bool[]")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"export async function checkBatch(request: PluginRequest): Promise<PluginResponse> {\n  const { user_uuid, permission_field, user_uuid2 } = request.body as any\n  const response = await fetchONES({\n    path: `BatchCheckPermission`,\n    headers: {\n      AbilityName: ['BatchCheckPermission'],\n    },\n    method: 'POST',\n    body: {\n      permission_rules: [\n        {\n          organization_uuid: global.onesEnv.organizationUUID,\n          permission_field: permission_field,\n          team_uuid: global.onesEnv.teamUUID,\n          instance_id: global.onesEnv.instanceId,\n          user_uuid: user_uuid,\n        },\n        {\n          organization_uuid: global.onesEnv.organizationUUID,\n          permission_field: permission_field,\n          team_uuid: global.onesEnv.teamUUID,\n          instance_id: global.onesEnv.instanceId,\n          user_uuid: user_uuid2,\n        },\n      ],\n    },\n  })\n  const body = response?.body as any\n  const data = JSON.parse(body.toString())['data']\n  Logger.info(data)\n  return {\n    body: {\n      data: data,\n    },\n  }\n}\n")),(0,r.kt)("h3",{id:"custom-permission-point-api---front-end"},"Custom Permission Point API - Front End"),(0,r.kt)("h4",{id:"get-permission-points-info"},"Get permission points info"),(0,r.kt)("p",null,"Get a list of custom permission points and their rules"),(0,r.kt)("h5",{id:"url"},"URL"),(0,r.kt)("p",null,"https://your-host-name/project/api/project/team/:team_uuid/plugin/permissioninfo/list"),(0,r.kt)("h5",{id:"http-method"},"HTTP Method"),(0,r.kt)("p",null,"POST"),(0,r.kt)("h5",{id:"transfer-method"},"Transfer method"),(0,r.kt)("p",null,"json"),(0,r.kt)("h5",{id:"list-of-request-parameters"},"List of request parameters"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"instance_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"plugin_instance_id")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"team_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"team",(0,r.kt)("inlineCode",{parentName:"td"},"uuid"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"organization_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"organization",(0,r.kt)("inlineCode",{parentName:"td"},"uuid"))))),(0,r.kt)("h5",{id:"returns-a-list-of-parameters"},"Returns a list of parameters"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("a",{parentName:"td",href:"#permission"},"permission"),"[]"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Array of custom permission points")))),(0,r.kt)("h5",{id:"example-of-request"},"Example of request"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-curl"},"curl --location 'https://your-host-name/project/api/project/team/:team_uuid/plugin/permissioninfo/list' \\\n--header 'Ones-User-Id: N5tnQP1D' \\\n--header 'Content-Type: application/json;charset=utf-8' \\\n--header 'Ones-Auth-Token: 9iiqA0As7UldZ61aOSpzaMAQclSRWXCAGOwNK2D3yolDYodoJGr764bpOVm2QVLp' \\\n--header 'Ones-Plugin-Id: built_in_apis' \\\n--data '{\n    \"instance_uuid\": \"994af1e3\".\n    \"team_uuid\": \"E1r1oDP1\".\n    \"organization_uuid\": \"9qcEhFjy\"\n}'\n")),(0,r.kt)("h5",{id:"return-example"},"Return Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "data": [\n        {\n            "instance_uuid": "994af1e3".\n            "permission_name": "Permission".\n            "permission_field": "my_permission".\n            "permission_id": "1646758032098463744".\n            "permission_desc": "Custom permission".\n            "check_mode": "standard".\n            "rule_info": [\n                {\n                    "id": "1646758267080151040".\n                    "permission": "1646758032098463744".\n                    "context_type": "plugin".\n                    "context_param_1": "994af1e3".\n                    "context_param_2": "".\n                    "user_domain_type": "single_user".\n                    "user_domain_param": "N5tnQP1D".\n                    "position": 1\n                }\n            ]\n        }\n    ]\n}\n')),(0,r.kt)("h4",{id:"check-permission-point-1"},"Check permission point"),(0,r.kt)("p",null,"Checks if a user has permission for a custom permission point"),(0,r.kt)("h5",{id:"url-1"},"URL"),(0,r.kt)("p",null,"https://your-host-name/project/api/project/team/:team_uuid/plugin/permissionrule/check"),(0,r.kt)("h5",{id:"http-method-1"},"HTTP Method"),(0,r.kt)("p",null,"POST"),(0,r.kt)("h5",{id:"transfer-method-1"},"Transfer method"),(0,r.kt)("p",null,"json"),(0,r.kt)("h5",{id:"list-of-request-param"},"List of request param"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"instance_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"plugin_instance_id")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"team_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"team",(0,r.kt)("inlineCode",{parentName:"td"},"uuid"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"organization_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"organization",(0,r.kt)("inlineCode",{parentName:"td"},"uuid"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_field"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Y"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"custom permission point configuration ",(0,r.kt)("inlineCode",{parentName:"td"},"field"))))),(0,r.kt)("h5",{id:"returns-a-list-of-parameters-1"},"Returns a list of parameters"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"is_permission"),(0,r.kt)("td",{parentName:"tr",align:"left"},"bool"),(0,r.kt)("td",{parentName:"tr",align:"left"},"whether to have permission")))),(0,r.kt)("h5",{id:"example-of-request-1"},"Example of request"),(0,r.kt)("p",null,"The value of the ",(0,r.kt)("inlineCode",{parentName:"p"},"Ones-User-Id")," parameter in the request header is the user for this verification"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-curl"},'curl --location \'http://your-host-name/project/api/project/team/E1r1oDP1/plugin/permissionrule/check\' \\\n--header \'Ones-User-Id: 6wFTfuTt\' \\\n--header \'Content-Type: application/json;charset=utf-8\' \\\n--header \'Ones-Plugin-Id: built_in_apis\' \\\n--data \'{\n    "instance_id": "994af1e3".\n    "team_uuid": "E1r1oDP1".\n    "organization_uuid": "9qcEhFjy".\n    "permission_field": "table_view_permission"\n}\'\n')),(0,r.kt)("h5",{id:"return-example-1"},"Return Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "data": {\n    "is_permission": true\n  }\n}\n')),(0,r.kt)("h3",{id:"custom-permission-ability"},"Custom permission ability"),(0,r.kt)("h4",{id:"step-1-add-configuration"},"Step 1: Add configuration"),(0,r.kt)("p",null,"Use ",(0,r.kt)("inlineCode",{parentName:"p"},"npx op add ability")," to add ",(0,r.kt)("inlineCode",{parentName:"p"},"custom-permission@1.0.0")," type ability, generate ",(0,r.kt)("inlineCode",{parentName:"p"},"backend/src/custom-permission.ts")," file and generate ability configuration in the plugin configuration file."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"The role of the parameters in the ability configuration:")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"name"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission point name"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"field"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission unique identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"desc"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission point description"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"is_plugin_custom_check"),(0,r.kt)("td",{parentName:"tr",align:"left"},"whether to use plugin custom permission verification"),(0,r.kt)("td",{parentName:"tr",align:"left"},"bool")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"abilities:\n  - id: WIXJvPcd\n    name: CustomPermission\n    version: 1.0.0\n    abilityType: CustomPermission\n    function:\n      customPermissionCheckFunc: customPermissionCheck\n    config:\n      - key: name\n        value: Permission\n        label: Permission name\n        show: false\n      - key: field\n        value: my_permission\n        label: Permission field\n        show: false\n      - key: desc\n        value: Custom permission\n        label: Permission description\n        show: false\n      - key: is_plugin_custom_check\n        value: false\n        label: Plugin custom permission verification\n        show: false\n")),(0,r.kt)("h4",{id:"step-2-write-permission-verification-function"},"Step 2: Write permission verification function"),(0,r.kt)("p",null,"According to the function name configured in ",(0,r.kt)("inlineCode",{parentName:"p"},"function.customPermissionCheckFunc")," in the ability configuration, add the corresponding permission check function in ",(0,r.kt)("inlineCode",{parentName:"p"},"backend/src/custom-permission.ts"),", which will be called when using the plugin custom permission check ."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Param:")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Param"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"user_uuid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"User's ",(0,r.kt)("inlineCode",{parentName:"td"},"uuid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"permission_field"),(0,r.kt)("td",{parentName:"tr",align:"left"},"permission unique identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"context"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Permission context parameters"),(0,r.kt)("td",{parentName:"tr",align:"left"},"PermissionContext")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"interface PermissionContext {\n  project_uuid?: string // ONES Projects -> project ID\n  filter_view_uuid?: string // My work -> Filters -> filter view ID\n  program_uuid?: string // ONES Program -> program ID\n  product_uuid?: string // Product Management -> product ID\n  testcase_library_uuid?: string // ONES TestCase -> Test case libarary -> test case library ID\n  test_plan_uuid?: string // ONES Testcase -> Test plans -> test planID\n  wiki_space_uuid?: string // ONES Wiki -> Spaces -> space ID\n  workspace_dashboard_uuid?: string // My work -> Dashboards -> dashboard ID\n  performance_dashboard_uuid?: string // ONES Performace -> Dashboard -> dashboard ID\n}\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"If the permission verification logic relies on permission context parameters, you also need to configure ",(0,r.kt)("a",{parentName:"p",href:"../../../reference/config/plugin.yaml#needPermissionContext"},"needPermissionContext")," as ",(0,r.kt)("inlineCode",{parentName:"p"},"true")," in the module that uses the permission point. Only in this way will the permission be re-verified when there are changes in the permission context.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Return: "),"Determine whether the permission check is passed by returning the value of the ",(0,r.kt)("inlineCode",{parentName:"p"},"is_permission")," field in the body"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example: "),"Only restrict users whose ",(0,r.kt)("inlineCode",{parentName:"p"},"user_uuid")," is ",(0,r.kt)("inlineCode",{parentName:"p"},"SFBs7BHh")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"import { Logger } from '@ones-op/node-logger'\nimport { PluginRequest, PluginResponse } from '@ones-op/node-types'\n\nexport async function customPermissionCheck(request: PluginRequest): Promise<PluginResponse> {\n  const body = request?.body as any\n  Logger.info(JSON.stringify(body, undefined, 2))\n  let permission = true\n  if (body.uuid == 'SFBs7BHh') {\n    permission = false\n  }\n  return {\n    statusCode: 200,\n    body: {\n      code: 200,\n      body: {\n        is_permission: permission,\n      },\n    },\n  }\n}\n")),(0,r.kt)("h2",{id:"examples"},"Examples"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/open-docs/docs/abilities/basic/custom-permission/system-sider-permission"},"System side component")))}f.isMDXComponent=!0}}]);