"use strict";(self.webpackChunkopen_docs=self.webpackChunkopen_docs||[]).push([[89542],{3905:(e,n,i)=>{i.d(n,{Zo:()=>p,kt:()=>c});var s=i(67294);function r(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function o(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,s)}return i}function t(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?o(Object(i),!0).forEach((function(n){r(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function a(e,n){if(null==e)return{};var i,s,r=function(e,n){if(null==e)return{};var i,s,r={},o=Object.keys(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)>=0||(r[i]=e[i]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var d=s.createContext({}),l=function(e){var n=s.useContext(d),i=n;return e&&(i="function"==typeof e?e(n):t(t({},n),e)),i},p=function(e){var n=l(e.components);return s.createElement(d.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return s.createElement(s.Fragment,{},n)}},m=s.forwardRef((function(e,n){var i=e.components,r=e.mdxType,o=e.originalType,d=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),m=l(i),c=r,y=m["".concat(d,".").concat(c)]||m[c]||u[c]||o;return i?s.createElement(y,t(t({ref:n},p),{},{components:i})):s.createElement(y,t({ref:n},p))}));function c(e,n){var i=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=i.length,t=new Array(o);t[0]=m;var a={};for(var d in n)hasOwnProperty.call(n,d)&&(a[d]=n[d]);a.originalType=e,a.mdxType="string"==typeof e?e:r,t[1]=a;for(var l=2;l<o;l++)t[l]=i[l];return s.createElement.apply(null,t)}return s.createElement.apply(null,i)}m.displayName="MDXCreateElement"},33420:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var s=i(87462),r=(i(67294),i(3905));const o={},t="\u63d2\u4ef6\u540e\u7aef permission \u80fd\u529b\u5f00\u53d1",a={unversionedId:"abilities/base/customPermission/permissionBackendAbility",id:"version-0.x/abilities/base/customPermission/permissionBackendAbility",title:"\u63d2\u4ef6\u540e\u7aef permission \u80fd\u529b\u5f00\u53d1",description:"\u6211\u4eec\u4e3a\u63d2\u4ef6\u5f00\u53d1\u8005\u63d0\u4f9b\u4e86\u975e\u58f0\u660e\u5f0f\u7684\u6743\u9650\u70b9\u5b9a\u4e49\u548c\u548c\u914d\u7f6e\u65b9\u6cd5\u3002\u5f00\u53d1\u8005\u53ef\u4ee5\u4f7f\u7528\u81ea\u884c\u5b9e\u73b0\u5176\u524d\u7aef\u6743\u9650\u914d\u7f6e\u9875\u9762\uff0c\u5e76\u5728\u540e\u7aef\u4f7f\u7528\u6211\u4eec\u63d0\u4f9b\u7684\u65b9\u6cd5\u6765\u7ba1\u7406\u63d2\u4ef6\u6743\u9650\u3002",source:"@site/versioned_docs/version-0.x/abilities/base/customPermission/permissionBackendAbility.md",sourceDirName:"abilities/base/customPermission",slug:"/abilities/base/customPermission/permissionBackendAbility",permalink:"/docs/0.x/abilities/base/customPermission/permissionBackendAbility",draft:!1,tags:[],version:"0.x",lastUpdatedBy:"liupengfei",lastUpdatedAt:1690791943,formattedLastUpdatedAt:"Jul 31, 2023",frontMatter:{},sidebar:"abilities",previous:{title:"\u63d2\u4ef6\u81ea\u5b9a\u4e49\u6743\u9650\u70b9 Demo \u5b9e\u4f8b",permalink:"/docs/0.x/abilities/base/customPermission/demo"},next:{title:"\u63d2\u4ef6\u81ea\u5b9a\u4e49\u914d\u7f6e\u9875\u9762",permalink:"/docs/0.x/abilities/base/customConfiguration/"}},d={},l=[{value:"1.\u6dfb\u52a0\u6743\u9650\u70b9 AddPermissionInfo",id:"1\u6dfb\u52a0\u6743\u9650\u70b9-addpermissioninfo",level:3},{value:"2.\u83b7\u53d6\u6743\u9650\u70b9 PermissionInfoList",id:"2\u83b7\u53d6\u6743\u9650\u70b9-permissioninfolist",level:3},{value:"3.\u5220\u9664\u6743\u9650\u70b9 DeletePermissionInfo",id:"3\u5220\u9664\u6743\u9650\u70b9-deletepermissioninfo",level:3},{value:"4.\u6dfb\u52a0\u6743\u9650\u89c4\u5219 AddPermissionRule",id:"4\u6dfb\u52a0\u6743\u9650\u89c4\u5219-addpermissionrule",level:3},{value:"5.\u68c0\u67e5\u662f\u5426\u6709\u67d0\u4e2a\u6743\u9650\u70b9\u6743\u9650 CheckPermissionRule",id:"5\u68c0\u67e5\u662f\u5426\u6709\u67d0\u4e2a\u6743\u9650\u70b9\u6743\u9650-checkpermissionrule",level:3},{value:"6.\u5220\u9664\u6743\u9650\u89c4\u5219 DeletePermissionRule",id:"6\u5220\u9664\u6743\u9650\u89c4\u5219-deletepermissionrule",level:3}],p={toc:l};function u(e){let{components:n,...i}=e;return(0,r.kt)("wrapper",(0,s.Z)({},p,i,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"\u63d2\u4ef6\u540e\u7aef-permission-\u80fd\u529b\u5f00\u53d1"},"\u63d2\u4ef6\u540e\u7aef permission \u80fd\u529b\u5f00\u53d1"),(0,r.kt)("p",null,"\u6211\u4eec\u4e3a\u63d2\u4ef6\u5f00\u53d1\u8005\u63d0\u4f9b\u4e86\u975e\u58f0\u660e\u5f0f\u7684\u6743\u9650\u70b9\u5b9a\u4e49\u548c\u548c\u914d\u7f6e\u65b9\u6cd5\u3002\u5f00\u53d1\u8005\u53ef\u4ee5\u4f7f\u7528\u81ea\u884c\u5b9e\u73b0\u5176\u524d\u7aef\u6743\u9650\u914d\u7f6e\u9875\u9762\uff0c\u5e76\u5728\u540e\u7aef\u4f7f\u7528\u6211\u4eec\u63d0\u4f9b\u7684\u65b9\u6cd5\u6765\u7ba1\u7406\u63d2\u4ef6\u6743\u9650\u3002"),(0,r.kt)("p",null,"\u6211\u4eec\u63d0\u4f9b\u4e86\u516d\u4e2a\u5bf9\u5e94\u7684\u65b9\u6cd5\uff0c\u4ee5\u4e0b\u662f\u5982\u4f55\u5728\u540e\u7aef\u4ee3\u7801\u4e2d\u4f7f\u7528\u4ed6\u4eec\u3002"),(0,r.kt)("h3",{id:"1\u6dfb\u52a0\u6743\u9650\u70b9-addpermissioninfo"},"1.\u6dfb\u52a0\u6743\u9650\u70b9 AddPermissionInfo"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'export async function addPermissionInfo(request: PluginRequest): Promise<PluginResponse> {\n  const body = request.body || {};\n  const response = await fetchONES(\n    {\n      path: `AddPermissionInfo`,\n      headers: {\n                 "AbilityName":["AddPermissionInfo"]\n                },\n      method: \'POST\',\n      body: {\n        "permission_name":"123",    // \u6743\u9650\u70b9\u540d\u79f0\n        "permission_field":"1234",  // \u6743\u9650\u70b9\u552f\u4e00\u6807\u8bc6\n        "permission_desc":"test",   // \u63d2\u4ef6\u70b9\u63cf\u8ff0\n      }\n    }\n  )\n  // @ts-ignore\n  Logger.info(JSON.parse(response?.body.toString())["data"])\n  return {\n    body: {\n      res: \'hello world\',\n      requestBody: body,\n    },\n  };\n}\n\nJSON.parse(response?.body.toString())["data"]\u503c\u6709\uff1a\n\u6b63\u5e38\uff1a\n{\n  id: 27,\n  create_time: 1646640153,\n  update_time: 1646640153,\n  deleted: false,\n  org_uuid: \'JGpj1YSe\',\n  team_uuid: \'ERWC2dHj\',\n  instance_uuid: \'21e54b52\',\n  permission_name: \'123\',\n  permission_desc: \'test\',\n  permission_field: \'1234\',\n  permission_id: 54242\n}\n\u5f02\u5e38\uff1a\n<AddPermissionInfo.PermissionFieldAlreadyExist> // permission\u6807\u8bc6\u5df2\u5b58\u5728\n')),(0,r.kt)("h3",{id:"2\u83b7\u53d6\u6743\u9650\u70b9-permissioninfolist"},"2.\u83b7\u53d6\u6743\u9650\u70b9 PermissionInfoList"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"export async function permissioninfolist(request: PluginRequest): Promise<PluginResponse> {\n  const body = request.body || {};\n  Logger.info('[Plugin] hello ======= \u8bf7\u6c42\u6210\u529f');\n  const response = await fetchONES(\n    {\n      path: `PermissionInfoList`,\n      headers: {\n                 \"AbilityName\":[\"PermissionInfoList\"]\n                },\n      method: 'POST',\n      body: {\n      }\n    }\n  )\n  // @ts-ignore\n  Logger.info(JSON.parse(response?.body.toString())[\"data\"])\n  return {\n    body: {\n      res: 'hello world',\n      requestBody: body,\n    },\n  };\n}\n\nJSON.parse(response?.body.toString())[\"data\"]\u503c\u6709\uff1a\n\u6b63\u5e38\uff1a\n[\n  {\n    org_uuid: 'JGpj1YSe',\n    team_uuid: 'ERWC2dHj',\n    instance_uuid: '21e54b52',\n    permission_name: '123',\n    permission_field: '123',\n    permission_id: 57725,\n    permission_desc: 'test',\n    rule_info: []\n  }\n]\n")),(0,r.kt)("h3",{id:"3\u5220\u9664\u6743\u9650\u70b9-deletepermissioninfo"},"3.\u5220\u9664\u6743\u9650\u70b9 DeletePermissionInfo"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"export async function deletepermissioninfo(request: PluginRequest): Promise<PluginResponse> {\n  const body = request.body || {};\n  const response = await fetchONES(\n    {\n      path: `DeletePermissionInfo`,\n      headers: {\n                 \"AbilityName\":[\"DeletePermissionInfo\"]\n                },\n      method: 'POST',\n      body: {\n        \"permission_field\": \"1234\"\n      }\n    }\n  )\n  // @ts-ignore\n  Logger.info(JSON.parse(response?.body.toString())[\"data\"])\n  return {\n    body: {\n      res: 'hello world',\n      requestBody: body,\n    },\n  };\n}\n\nJSON.parse(response?.body.toString())[\"data\"]\u503c\u6709\uff1a\n\u6b63\u5e38\uff1a\n[\n  {\n    org_uuid: 'JGpj1YSe',\n    team_uuid: 'ERWC2dHj',\n    instance_uuid: '21e54b52',\n    permission_name: '123',\n    permission_field: '123',\n    permission_id: 57725,\n    permission_desc: 'test',\n    rule_info: []\n  }\n]\n")),(0,r.kt)("h3",{id:"4\u6dfb\u52a0\u6743\u9650\u89c4\u5219-addpermissionrule"},"4.\u6dfb\u52a0\u6743\u9650\u89c4\u5219 AddPermissionRule"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'export async function addPermissionRule(request: PluginRequest): Promise<PluginResponse> {\n  const body = request.body || {};\n  const response = await fetchONES(\n    {\n      path: `AddPermissionRule`,\n      headers: {\n                 "AbilityName":["AddPermissionRule"]\n                },\n      method: \'POST\',\n      body: {\n        "permission_id": 58638,            // permission\u552f\u4e00id\uff0c\u5728add_permission_info\u65f6\u8fd4\u56de\n        "user_domain_type": "single_user", // \u7528\u6237\u57df\u79cd\u7c7b\uff0c\u73b0\u6709\uff1aeveryone,single_user,department,group,team_owner\n        "user_domain_param": "1233333",    // \u7528\u6237\u9886\u57df\u7684\u552f\u4e00\u6807\u793a\uff0c\u4f8b\u5982\u5f53user_domain_type\u662fsingle_user\u65f6\uff0cuser_domain_param\u5c31\u662f\u6807\u793auser_uuid\n      }\n    }\n  )\n  // @ts-ignore\n  Logger.info(JSON.parse(response?.body.toString())["data"])\n  return {\n    body: {\n      res: \'hello world\',\n      requestBody: body,\n    },\n  };\n}\n\nJSON.parse(response?.body.toString())["data"]\u503c\u6709\uff1a\n\u6b63\u5e38:\n {\n  id: 1,\n  create_time: 1646708993,\n  update_time: 1646708993,\n  deleted: false,\n  org_uuid: \'JGpj1YSe\',\n  team_uuid: \'ERWC2dHj\',\n  permission_id: 59290,\n  context_type: 5001,          // \u5f53\u524d\u6743\u9650\u4f53\u7cfb\uff0c\u63d2\u4ef6\u5f00\u53d1\u8005\u4e0d\u7528\u5173\u5fc3\n  context_param_1: \'21e54b52\',\n  context_param_2: \'\',\n  user_domain_type: 1,\n  user_domain_param: \'1233333\',\n  position: 0\n}\n\u5f02\u5e38:\n<UserDomainNotExist> UserDomainNotExist // \u7528\u6237\u57df\u7c7b\u578b\u4e0d\u5b58\u5728\n')),(0,r.kt)("h3",{id:"5\u68c0\u67e5\u662f\u5426\u6709\u67d0\u4e2a\u6743\u9650\u70b9\u6743\u9650-checkpermissionrule"},"5.\u68c0\u67e5\u662f\u5426\u6709\u67d0\u4e2a\u6743\u9650\u70b9\u6743\u9650 CheckPermissionRule"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'export async function checkPermissionRule(request: PluginRequest): Promise<PluginResponse> {\n  const body = request.body || {};\n  Logger.info(\'[Plugin] hello ======= \u8bf7\u6c42\u6210\u529f\');\n  const response = await fetchONES(\n    {\n      path: `CheckPermissionRule`,\n      headers: {\n                 "AbilityName":["CheckPermissionRule"]\n                },\n      method: \'POST\',\n      body: {\n        "permission_field": "1234",\n        "user_uuid": "123333388",\n      }\n    }\n  )\n  // @ts-ignore\n  Logger.info(JSON.parse(response?.body.toString())["data"])\n  return {\n    body: {\n      res: \'hello world\',\n      requestBody: body,\n    },\n  };\n}\n\nJSON.parse(response?.body.toString())["data"]\u503c\u6709\uff1a\n\u6b63\u5e38\uff1a\n { is_permission: true }\n { is_permission: false }\n\n\u5f02\u5e38\uff1a\n <ServerError> permission not exist\n')),(0,r.kt)("h3",{id:"6\u5220\u9664\u6743\u9650\u89c4\u5219-deletepermissionrule"},"6.\u5220\u9664\u6743\u9650\u89c4\u5219 DeletePermissionRule"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'export async function deletePermissionRule(request: PluginRequest): Promise<PluginResponse> {\n  const body = request.body || {};\n  const response = await fetchONES(\n    {\n      path: `DeletePermissionRule`,\n      headers: {\n                 "AbilityName":["DeletePermissionRule"]\n                },\n      method: \'POST\',\n      body: {\n        "id": 12, // permission_rule\u552f\u4e00id\uff0c\u5728add_permission_rule\u65f6\u4f1a\u8fd4\u56de\n      }\n    }\n  )\n  // @ts-ignore\n  Logger.info(JSON.parse(response?.body.toString())["data"])\n  return {\n    body: {\n      res: \'hello world\',\n      requestBody: body,\n    },\n  };\n}\n\nJSON.parse(response?.body.toString())["data"]\n\u8fd4\u56de\u503c\uff1a\nsuccess\n')))}u.isMDXComponent=!0}}]);