(self.webpackChunkopen_docs=self.webpackChunkopen_docs||[]).push([[5806],{60267:(e,t,n)=>{e.exports={src:{srcSet:n.p+"assets/ideal-img/chromium-inspect.6e44d74.1024.png 1024w,"+n.p+"assets/ideal-img/chromium-inspect.81c6203.1792.png 1792w,"+n.p+"assets/ideal-img/chromium-inspect.45fdba8.2560.png 2560w",images:[{path:n.p+"assets/ideal-img/chromium-inspect.6e44d74.1024.png",width:1024,height:606},{path:n.p+"assets/ideal-img/chromium-inspect.81c6203.1792.png",width:1792,height:1061},{path:n.p+"assets/ideal-img/chromium-inspect.45fdba8.2560.png",width:2560,height:1515}],src:n.p+"assets/ideal-img/chromium-inspect.6e44d74.1024.png",toString:function(){return n.p+"assets/ideal-img/chromium-inspect.6e44d74.1024.png"},placeholder:void 0,width:1024,height:606},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAIAAAB1kpiRAAAACXBIWXMAABYlAAAWJQFJUiTwAAAASElEQVQImZXNMRKAMAhE0dz/shpwhwCyccYupvK3r/gNwAW4O4C51SLiOKWLimjmXVULk+yiw2MMN7PM/HIV52S9kVx4//3gB0cSsbtO3zHFAAAAAElFTkSuQmCC"}},32917:(e,t,n)=>{e.exports={src:{srcSet:n.p+"assets/ideal-img/devtools.64d1520.1024.png 1024w,"+n.p+"assets/ideal-img/devtools.7159a40.1230.png 1230w",images:[{path:n.p+"assets/ideal-img/devtools.64d1520.1024.png",width:1024,height:737},{path:n.p+"assets/ideal-img/devtools.7159a40.1230.png",width:1230,height:885}],src:n.p+"assets/ideal-img/devtools.64d1520.1024.png",toString:function(){return n.p+"assets/ideal-img/devtools.64d1520.1024.png"},placeholder:void 0,width:1024,height:737},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAHCAYAAAAxrNxjAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAn0lEQVQYlX3MMQrCMBTG8dzL1fOUTuIu6CJ4AXUSDyJ6gLRFSDdN00F0aBOTquV7EgmiRfzgz1t+PJYkaSylknVtuLVNdjX2lbXOX15V+lAU5Yhl2X56Ol/o37TWK3Ys1NhYRwQ0ANpOtwAXTKpy4iGAO3n+vUeAy/dHAI6I2s8ANAHOPZwF+LMA12yz3fV4mg6FEJEQIu4U5Xk+4Jz3n3bdAB7nPy8oAAAAAElFTkSuQmCC"}},74737:(e,t,n)=>{e.exports={src:{srcSet:n.p+"assets/ideal-img/vscode-debug.e6fbea8.1024.png 1024w,"+n.p+"assets/ideal-img/vscode-debug.0deffb1.1130.png 1130w",images:[{path:n.p+"assets/ideal-img/vscode-debug.e6fbea8.1024.png",width:1024,height:198},{path:n.p+"assets/ideal-img/vscode-debug.0deffb1.1130.png",width:1130,height:218}],src:n.p+"assets/ideal-img/vscode-debug.e6fbea8.1024.png",toString:function(){return n.p+"assets/ideal-img/vscode-debug.e6fbea8.1024.png"},placeholder:void 0,width:1024,height:198},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAACCAYAAABhYU3QAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAQklEQVQImU3KOQ7AIAwFUS5iC/DCJlOQ+5/tR6KIUkw1L/UVmPvA1OAqcCkoOYOIwMxfSdtEiwd9BIbZhS71zj9+AXTTHClCak6LAAAAAElFTkSuQmCC"}},40012:(e,t,n)=>{e.exports={src:{srcSet:n.p+"assets/ideal-img/vscode-debugger-view.918e48e.1024.png 1024w,"+n.p+"assets/ideal-img/vscode-debugger-view.3acb169.1792.png 1792w,"+n.p+"assets/ideal-img/vscode-debugger-view.712814e.1942.png 1942w",images:[{path:n.p+"assets/ideal-img/vscode-debugger-view.918e48e.1024.png",width:1024,height:451},{path:n.p+"assets/ideal-img/vscode-debugger-view.3acb169.1792.png",width:1792,height:790},{path:n.p+"assets/ideal-img/vscode-debugger-view.712814e.1942.png",width:1942,height:856}],src:n.p+"assets/ideal-img/vscode-debugger-view.918e48e.1024.png",toString:function(){return n.p+"assets/ideal-img/vscode-debugger-view.918e48e.1024.png"},placeholder:void 0,width:1024,height:451},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAECAIAAAA4WjmaAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAXklEQVQImUXMUQqEMAxF0W5lHDBok5i+1pgMg+5/V/4p3L8Dt7DFl+Qzy6r7aNEsiMdTYSQxiLvYb/gFpGxe1R8O7cl2bMjzvI50GxCYoimsSP/PFRPpom6Iak7yzm9rUBZ8R/wwugAAAABJRU5ErkJggg=="}},17942:(e,t,n)=>{"use strict";n.d(t,{Zo:()=>s,kt:()=>m});var i=n(50959);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=i.createContext({}),g=function(e){var t=i.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},s=function(e){var t=g(e.components);return i.createElement(p.Provider,{value:t},e.children)},l="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},c=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,s=d(e,["components","mdxType","originalType","parentName"]),l=g(n),c=a,m=l["".concat(p,".").concat(c)]||l[c]||u[c]||o;return n?i.createElement(m,r(r({ref:t},s),{},{components:n})):i.createElement(m,r({ref:t},s))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=c;var d={};for(var p in t)hasOwnProperty.call(t,p)&&(d[p]=t[p]);d.originalType=e,d[l]="string"==typeof e?e:a,r[1]=d;for(var g=2;g<o;g++)r[g]=n[g];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}c.displayName="MDXCreateElement"},74360:(e,t,n)=>{"use strict";n.r(t),n.d(t,{assets:()=>g,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>p,toc:()=>s});var i=n(28957),a=(n(50959),n(17942)),o=n(49500);const r={},d="Debugging",p={unversionedId:"guide/advanced/debugger",id:"guide/advanced/debugger",title:"Debugging",description:"Overview",source:"@site/docs/guide/advanced/debugger.mdx",sourceDirName:"guide/advanced",slug:"/guide/advanced/debugger",permalink:"/open-docs/docs/guide/advanced/debugger",draft:!1,tags:[],version:"current",lastUpdatedBy:"liupengfei",lastUpdatedAt:1703230356,formattedLastUpdatedAt:"Dec 22, 2023",frontMatter:{},sidebar:"guide",previous:{title:"Advanced Guide",permalink:"/open-docs/docs/guide/advanced/"},next:{title:"Runtime Environment",permalink:"/open-docs/docs/guide/advanced/runtime-environment"}},g={},s=[{value:"Overview",id:"overview",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Usage",id:"usage",level:2},{value:"Step 1: Add <code>debugger</code> code",id:"step-1-add-debugger-code",level:3},{value:"Step 2: Select the tool to connect to the debugging service",id:"step-2-select-the-tool-to-connect-to-the-debugging-service",level:3},{value:"Visual Studio Code",id:"visual-studio-code",level:4},{value:"Start",id:"start",level:5},{value:"Debug preview",id:"debug-preview",level:5},{value:"Chromium",id:"chromium",level:4}],l=(u="Image",function(e){return o.warn("Component "+u+" was not imported, exported, or provided by MDXProvider as global scope"),(0,a.kt)("div",e)});var u;const c={toc:s},m="wrapper";function h(e){let{components:t,...o}=e;return(0,a.kt)(m,(0,i.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"debugging"},"Debugging"),(0,a.kt)("h2",{id:"overview"},"Overview"),(0,a.kt)("p",null,"This section describes how to breakpoint debugging of backend code when running the plugin locally. Since the backend code of a plugin is not a separate project, but a piece of code running in a sandbox, breakpoint debugging is done a little differently than in a regular Node.js project."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"For more information on how the plugin works, please consult: ",(0,a.kt)("a",{parentName:"p",href:"/open-docs/docs/guide/advanced/runtime-environment"},(0,a.kt)("strong",{parentName:"a"},"Runtime Environment")),".")),(0,a.kt)("h2",{id:"requirements"},"Requirements"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"@ones/node-host"),(0,a.kt)("th",{parentName:"tr",align:null},"@ones/cli-plugin"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"v0.1.15+"),(0,a.kt)("td",{parentName:"tr",align:null},"v1.9.1+")))),(0,a.kt)("h2",{id:"usage"},"Usage"),(0,a.kt)("p",null,"We provide the Npm Script configuration in the plugin template, which includes the ",(0,a.kt)("inlineCode",{parentName:"p"},"debug")," command that you can run with the debugging tool for breakpoint debugging."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"We add the ",(0,a.kt)("inlineCode",{parentName:"p"},"inspect")," parameter to the Node.js HOST application when it runs, and the host and port use the default provided by Node.js: ",(0,a.kt)("inlineCode",{parentName:"p"},"127.0.0.1:9229"),". Common debugging tools usually include this default address, and in most cases you don't need to do any additional configuration.")),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"The Node.js Host has a time limit for connecting to the open platform, which is usually exceeded when you do a breakpoint debug.",(0,a.kt)("br",{parentName:"p"}),"\n","So when you breakpoint, you may need to re-run the ",(0,a.kt)("inlineCode",{parentName:"p"},"run")," command to get the plugin up and running.")),(0,a.kt)("h3",{id:"step-1-add-debugger-code"},"Step 1: Add ",(0,a.kt)("inlineCode",{parentName:"h3"},"debugger")," code"),(0,a.kt)("p",null,"Unlike the regular Node.js breakpoint debugging approach, plugin backend breakpoint debugging requires you to write a minimum of one line of ",(0,a.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/debugger"},(0,a.kt)("inlineCode",{parentName:"a"},"debugger"))," code in order for the debugging tool to locate and open your backend code ",(0,a.kt)("strong",{parentName:"p"},"memory file"),". You can only add breakpoints to this read-only ",(0,a.kt)("strong",{parentName:"p"},"memory file")," for debugging."),(0,a.kt)("p",null,"In general, we recommend that you add ",(0,a.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/debugger"},(0,a.kt)("inlineCode",{parentName:"a"},"debugger"))," to the first line of the function body you need to debug to make it easier to add breakpoints before the function is executed."),(0,a.kt)("h3",{id:"step-2-select-the-tool-to-connect-to-the-debugging-service"},"Step 2: Select the tool to connect to the debugging service"),(0,a.kt)("h4",{id:"visual-studio-code"},"Visual Studio Code"),(0,a.kt)("p",null,"Visual Studio Code provides the ",(0,a.kt)("inlineCode",{parentName:"p"},"Debug npm Script")," feature, which can run your Npm Script in debug mode and take over the debugging features of the program."),(0,a.kt)("h5",{id:"start"},"Start"),(0,a.kt)("p",null,"Way 1: Open the ",(0,a.kt)("inlineCode",{parentName:"p"},"package.json")," file in the root directory and debug the ",(0,a.kt)("inlineCode",{parentName:"p"},"debug")," command."),(0,a.kt)(l,{img:n(74737),mdxType:"Image"}),(0,a.kt)("p",null,"Way 2: Create a new Javascript debugging terminal and run the ",(0,a.kt)("inlineCode",{parentName:"p"},"debug")," command."),(0,a.kt)("h5",{id:"debug-preview"},"Debug preview"),(0,a.kt)("p",null,"Request your method, and seeing this interface means that the debugging has been successfully enabled. The system will first stop at the position where you wrote the debugger, and then you can add breakpoints or the next step like formal debugging."),(0,a.kt)(l,{img:n(40012),mdxType:"Image"}),(0,a.kt)("h4",{id:"chromium"},"Chromium"),(0,a.kt)("p",null,"After manually running the ",(0,a.kt)("inlineCode",{parentName:"p"},"npx op invoke run")," command to get the local plugin up and running, you can, in Chromium-based browsers (e.g. ",(0,a.kt)("a",{parentName:"p",href:"https://www.microsoft.com/edge/"},"Edge"),", ",(0,a.kt)("a",{parentName:"p",href:"https://www.google.com/chrome/"},"Chrome"),", etc.) Open ",(0,a.kt)("inlineCode",{parentName:"p"},"about://inspect")," to see the devices that can be connected."),(0,a.kt)(l,{img:n(60267),mdxType:"Image"}),(0,a.kt)("p",null,"After selecting inspect, the browser will open a DevTools with your current plugin backend debugging service connected to it. at this point, you just need to make an interface call to get the program into the function where you added the ",(0,a.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/debugger"},(0,a.kt)("inlineCode",{parentName:"a"},"debugger"))," code, and DevTools will enter the breakpoint and open your plugin backend code ",(0,a.kt)("strong",{parentName:"p"},"memory file")," where you can add additional breakpoints for debugging."),(0,a.kt)(l,{img:n(32917),mdxType:"Image"}))}h.isMDXComponent=!0}}]);