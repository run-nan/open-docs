(self.webpackChunkopen_docs=self.webpackChunkopen_docs||[]).push([[4159],{1645:(e,t,n)=>{e.exports={src:{srcSet:n.p+"assets/ideal-img/block.d90e1a8.1024.png 1024w,"+n.p+"assets/ideal-img/block.4439cd0.1792.png 1792w,"+n.p+"assets/ideal-img/block.e063b69.2440.png 2440w",images:[{path:n.p+"assets/ideal-img/block.d90e1a8.1024.png",width:1024,height:628},{path:n.p+"assets/ideal-img/block.4439cd0.1792.png",width:1792,height:1099},{path:n.p+"assets/ideal-img/block.e063b69.2440.png",width:2440,height:1496}],src:n.p+"assets/ideal-img/block.d90e1a8.1024.png",toString:function(){return n.p+"assets/ideal-img/block.d90e1a8.1024.png"},placeholder:void 0,width:1024,height:628},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAVElEQVQImY2MMQqAQAwE7/8PtRXBIpdkMxILQZtzYbqdGWaG2aQAVVEPoEzkk21PhlTsx4lPxz3w0IsUnWC0nRGkO0rR4peuj/6v1rG7uKL3q9jHC/N37cB6+gf6AAAAAElFTkSuQmCC"}},9763:(e,t,n)=>{e.exports={src:{srcSet:n.p+"assets/ideal-img/box.8ad2c5b.1024.png 1024w,"+n.p+"assets/ideal-img/box.e3a842f.1792.png 1792w,"+n.p+"assets/ideal-img/box.e9c75ed.2418.png 2418w",images:[{path:n.p+"assets/ideal-img/box.8ad2c5b.1024.png",width:1024,height:633},{path:n.p+"assets/ideal-img/box.e3a842f.1792.png",width:1792,height:1108},{path:n.p+"assets/ideal-img/box.e9c75ed.2418.png",width:2418,height:1495}],src:n.p+"assets/ideal-img/box.8ad2c5b.1024.png",toString:function(){return n.p+"assets/ideal-img/box.8ad2c5b.1024.png"},placeholder:void 0,width:1024,height:633},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAVklEQVQImY2MQQqAMAwE8/9vevakbYNtdsSCtgiCA0uyYYi5F0pKRK09ikASAqI1VJ1lbRgSed/IqXC4o2hcXPIgsLne3B/77AEbZeSRp93exy+6+IcTCuTt94dGFhsAAAAASUVORK5CYII="}},53798:(e,t,n)=>{e.exports={src:{srcSet:n.p+"assets/ideal-img/editor.cac5e01.1024.png 1024w,"+n.p+"assets/ideal-img/editor.d2abd76.1792.png 1792w,"+n.p+"assets/ideal-img/editor.0027fee.2440.png 2440w",images:[{path:n.p+"assets/ideal-img/editor.cac5e01.1024.png",width:1024,height:628},{path:n.p+"assets/ideal-img/editor.d2abd76.1792.png",width:1792,height:1099},{path:n.p+"assets/ideal-img/editor.0027fee.2440.png",width:2440,height:1496}],src:n.p+"assets/ideal-img/editor.cac5e01.1024.png",toString:function(){return n.p+"assets/ideal-img/editor.cac5e01.1024.png"},placeholder:void 0,width:1024,height:628},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAaklEQVQImU2OCwrAIAxDvf9tt6GunzSjKtNACqWPpOV+KltX1q58e2NEDAOgmQ2rKstVhWJBM2d7bsKNAQwToCecoKoxlSkiSrj/YMDn7p6gLhDsklUHuN5I78Qxt/J4qtjb5sFXzZFyJn6lYe0dSEPA3AAAAABJRU5ErkJggg=="}},42537:(e,t,n)=>{e.exports={src:{srcSet:n.p+"assets/ideal-img/embed.147f9cc.1024.png 1024w,"+n.p+"assets/ideal-img/embed.d2a3e8f.1792.png 1792w,"+n.p+"assets/ideal-img/embed.c1f2c16.2440.png 2440w",images:[{path:n.p+"assets/ideal-img/embed.147f9cc.1024.png",width:1024,height:628},{path:n.p+"assets/ideal-img/embed.d2a3e8f.1792.png",width:1792,height:1099},{path:n.p+"assets/ideal-img/embed.c1f2c16.2440.png",width:2440,height:1496}],src:n.p+"assets/ideal-img/embed.147f9cc.1024.png",toString:function(){return n.p+"assets/ideal-img/embed.147f9cc.1024.png"},placeholder:void 0,width:1024,height:628},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAUElEQVQImYWMQQqAMBDE+v+HevVUWdvZiUgRrIcayC2kRAQtAmycOanW0Blsuyi2qfXAqSkiRb9DCcgRqndSHesbD20oLPCjPY5/3svl8c0FCc/t3oNcD28AAAAASUVORK5CYII="}},32967:(e,t,n)=>{e.exports={src:{srcSet:n.p+"assets/ideal-img/insert-by-add-button.21ae129.1024.png 1024w,"+n.p+"assets/ideal-img/insert-by-add-button.d24bdb0.1792.png 1792w,"+n.p+"assets/ideal-img/insert-by-add-button.c9b564d.2440.png 2440w",images:[{path:n.p+"assets/ideal-img/insert-by-add-button.21ae129.1024.png",width:1024,height:628},{path:n.p+"assets/ideal-img/insert-by-add-button.d24bdb0.1792.png",width:1792,height:1099},{path:n.p+"assets/ideal-img/insert-by-add-button.c9b564d.2440.png",width:2440,height:1496}],src:n.p+"assets/ideal-img/insert-by-add-button.21ae129.1024.png",toString:function(){return n.p+"assets/ideal-img/insert-by-add-button.21ae129.1024.png"},placeholder:void 0,width:1024,height:628},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAc0lEQVQImVWP7QrDMAgA8/4Pur9jLE38zJUkrGsFUfA8sYgIKh3GYDwSRibpyusdlMzkqJWIWMAV957cYO+Cu1/gvf7s23g02lEJ9wfwlw9KZPL5NmqtiChmjpphZjQNPHLBZdLz7ByKKvO5vWCIGB6xwBPZDeytRvNELwAAAABJRU5ErkJggg=="}},92743:(e,t,n)=>{e.exports={src:{srcSet:n.p+"assets/ideal-img/insert-by-menu.30dd302.1024.png 1024w,"+n.p+"assets/ideal-img/insert-by-menu.68eccf4.1792.png 1792w,"+n.p+"assets/ideal-img/insert-by-menu.3459c6f.2440.png 2440w",images:[{path:n.p+"assets/ideal-img/insert-by-menu.30dd302.1024.png",width:1024,height:628},{path:n.p+"assets/ideal-img/insert-by-menu.68eccf4.1792.png",width:1792,height:1099},{path:n.p+"assets/ideal-img/insert-by-menu.3459c6f.2440.png",width:2440,height:1496}],src:n.p+"assets/ideal-img/insert-by-menu.30dd302.1024.png",toString:function(){return n.p+"assets/ideal-img/insert-by-menu.30dd302.1024.png"},placeholder:void 0,width:1024,height:628},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAdElEQVQImV2OSw5EIQgEvf9BZzuL5wjysSZo3DwS6IQuOjRVRUVxD8yMyCRzkQvCg7DJ5xu0iKB34TcUEcE8sQCLtbUOIGnuvpOmGTIEm7McoIjTa3HA5+n0ShyDqXqwVcCBSluN+mkvb1a5r2rvxYVu4gX/isbtAg6q7vUAAAAASUVORK5CYII="}},52587:(e,t,n)=>{e.exports={src:{srcSet:n.p+"assets/ideal-img/insert-by-shortcut.b7bbd7c.1024.png 1024w,"+n.p+"assets/ideal-img/insert-by-shortcut.ade45f7.1792.png 1792w,"+n.p+"assets/ideal-img/insert-by-shortcut.7b899d1.2440.png 2440w",images:[{path:n.p+"assets/ideal-img/insert-by-shortcut.b7bbd7c.1024.png",width:1024,height:628},{path:n.p+"assets/ideal-img/insert-by-shortcut.ade45f7.1792.png",width:1792,height:1099},{path:n.p+"assets/ideal-img/insert-by-shortcut.7b899d1.2440.png",width:2440,height:1496}],src:n.p+"assets/ideal-img/insert-by-shortcut.b7bbd7c.1024.png",toString:function(){return n.p+"assets/ideal-img/insert-by-shortcut.b7bbd7c.1024.png"},placeholder:void 0,width:1024,height:628},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAaklEQVQImV2OUQoDMQhEvf9B+1uWbhNjoq+Y7C4lwuCgj1FRVZoquBOpiCXAx8Ct8XoPJIff86R3m8BT/x5H3J1aFet9JkImJnclT7HAUgqf42CYLfBKvC9kF4+gNpt/pr8Xe8k+eKAN/gHy7u2Me+6ZEQAAAABJRU5ErkJggg=="}},17942:(e,t,n)=>{"use strict";n.d(t,{Zo:()=>p,kt:()=>u});var o=n(50959);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=o.createContext({}),d=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=d(e.components);return o.createElement(s.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=d(n),m=i,u=c["".concat(s,".").concat(m)]||c[m]||h[m]||a;return n?o.createElement(u,r(r({ref:t},p),{},{components:n})):o.createElement(u,r({ref:t},p))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,r=new Array(a);r[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:i,r[1]=l;for(var d=2;d<a;d++)r[d]=n[d];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4725:(e,t,n)=>{"use strict";n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>g,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var o=n(28957),i=(n(50959),n(17942)),a=n(49500);const r={id:"wiki-collaborative-page",sidebar_position:1,description:"Support inline elements(Box), block elements(Block), and embed elements(Embed)."},l="Macro",s={unversionedId:"abilities/business/wiki/wiki-collaborative-page/wiki-collaborative-page",id:"abilities/business/wiki/wiki-collaborative-page/wiki-collaborative-page",title:"Macro",description:"Support inline elements(Box), block elements(Block), and embed elements(Embed).",source:"@site/docs/abilities/business/wiki/wiki-collaborative-page/index.mdx",sourceDirName:"abilities/business/wiki/wiki-collaborative-page",slug:"/abilities/business/wiki/wiki-collaborative-page/",permalink:"/open-docs/docs/abilities/business/wiki/wiki-collaborative-page/",draft:!1,tags:[],version:"current",lastUpdatedBy:"liupengfei",lastUpdatedAt:1703234094,formattedLastUpdatedAt:"Dec 22, 2023",sidebarPosition:1,frontMatter:{id:"wiki-collaborative-page",sidebar_position:1,description:"Support inline elements(Box), block elements(Block), and embed elements(Embed)."},sidebar:"abilities",previous:{title:"Third import",permalink:"/open-docs/docs/abilities/business/project/third-import"},next:{title:"Simple macro",permalink:"/open-docs/docs/abilities/business/wiki/wiki-macro/"}},d={},p=[{value:"Requirements",id:"requirements",level:2},{value:"Overview",id:"overview",level:2},{value:"Slots",id:"slots",level:2},{value:"ones:wiki:editor:decorator",id:"oneswikieditordecorator",level:4},{value:"Usage",id:"usage",level:2},{value:"Step 1: Add the module through the OP tool:",id:"step-1-add-the-module-through-the-op-tool",level:3},{value:"Step 2: Register shortcut:",id:"step-2-register-shortcut",level:3},{value:"Step 3: Render the plugin",id:"step-3-render-the-plugin",level:3},{value:"Block",id:"block",level:4},{value:"Embed",id:"embed",level:4},{value:"Box",id:"box",level:4},{value:"Step 4: Export to PDF/Word",id:"step-4-export-to-pdfword",level:3}],c=(h="Image",function(e){return a.warn("Component "+h+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",e)});var h;const m={toc:p},u="wrapper";function g(e){let{components:t,...a}=e;return(0,i.kt)(u,(0,o.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"macro"},"Macro"),(0,i.kt)("h2",{id:"requirements"},"Requirements"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"center"},"ONES"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"center"},"v3.16.8+")))),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)(c,{img:n(53798),mdxType:"Image"}),(0,i.kt)("p",null,'We have provided slots for "ONES Wiki" - "Spaces" - "select a space" - "Wiki collaborative page" to customize the page module for the application.'),(0,i.kt)("p",null,"Support inline elements(Box), block elements(Block), and embed elements(Embed)."),(0,i.kt)("p",null,"The slots currently supported are as follows:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#oneswikieditordecorator"},"ones:wiki:editor:decorator"))),(0,i.kt)("h2",{id:"slots"},"Slots"),(0,i.kt)("h4",{id:"oneswikieditordecorator"},"ones:wiki:editor:decorator"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Module path\uff1a")," ONES Wiki / Spaces / select a space / Wiki collaborative page"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Number limit\uff1a")," Declare a maximum of ",(0,i.kt)("strong",{parentName:"p"},"10")," slots in each plugin, and up to ",(0,i.kt)("strong",{parentName:"p"},"10")," slots in the system."),(0,i.kt)("h2",{id:"usage"},"Usage"),(0,i.kt)("h3",{id:"step-1-add-the-module-through-the-op-tool"},"Step 1: Add the module through the OP tool:"),(0,i.kt)("p",null,"Use the Command Line to enter the OP command in the plugin root directory to add a module:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"npx op add module\n")),(0,i.kt)("p",null,"Select the module type ",(0,i.kt)("inlineCode",{parentName:"p"},"ones:wiki:editor:decorator"),", and the OP tool add the module in the ",(0,i.kt)("inlineCode",{parentName:"p"},"plugin.yaml"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"modules:\n  - id: ones-wiki-editor-decorator-lsE4\n    title: test\n    moduleType: ones:wiki:editor:decorator\n    entry: modules/ones-wiki-editor-decorator-lsE4/index.html\n    icon: logo.svg\n")),(0,i.kt)("p",null,"This is the available hook API used in the module blow."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/open-docs/docs/reference/packages/editor/#useDefaultEditor"},"useDefaultEditor")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/open-docs/docs/reference/packages/editor/#useDefaultEditorTools"},"useDefaultEditorTools"))),(0,i.kt)("h3",{id:"step-2-register-shortcut"},"Step 2: Register shortcut:"),(0,i.kt)("p",null,'If the user wants to use your plugin in the editor, there are three ways to add plugin into the document: click "+",\nentry "/", or "Insert above"/"Insert below" in the menu.'),(0,i.kt)(c,{img:n(32967),mdxType:"Image"}),(0,i.kt)(c,{img:n(52587),mdxType:"Image"}),(0,i.kt)(c,{img:n(92743),mdxType:"Image"}),(0,i.kt)("p",null,"You can register a entry in these ways for you plugin by the hook ",(0,i.kt)("inlineCode",{parentName:"p"},"useRegisterCommand"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx"},"import { useRegisterCommand } from '@ones-op/editor'\n\nconst config: EditorBlockConfig = {\n  'my-tabs': {\n    render: BlockTabs,\n    icon: './logo.svg',\n    name: 'my-tabs',\n  },\n}\n\nconst embedConfig: EditorEmbedConfig = {\n  embedType: {\n    render: EmbedBlock,\n    name: 'embed',\n    icon: './logo.svg',\n  },\n}\n\nfunction App() {\n  const registerCommand = useRegisterCommand()\n  const editor = useDefaultEditor()\n  const tools = useDefaultEditorTools()\n\n  useEffect(() => {\n    registerCommand({\n      commandItems: [\n        {\n          id: 'tabs',\n          name: 'tabs',\n          icon: './logo.svg',\n          subText: '/tabs',\n        },\n        {\n          id: 'embed',\n          name: 'embed',\n          icon: './logo.svg',\n          subText: '/embed',\n        },\n      ],\n      async executeCommand(options) {\n        let containerId: string | undefined\n        let blockIndex = 0\n        if (options.params.from === 'quick-menu') {\n          // When the user clicks the \"/\" button, this code will run.\n          const block = editor.getBlockById(options.params.blockId)\n          const container = editor.getParentContainer(block)\n          containerId = tools.getContainerId(container)\n          blockIndex = editor.getBlockIndex(block)\n        }\n        if (options.params.from === 'add-block-menu') {\n          // When the user clicks the \"+\" button, this code will run.\n          // Please implement the logic\n        }\n        if (options.params.from === 'block-menu') {\n          // When the user clicks the \"Insert above\"/\"Insert below\" button, this code will run.\n          // Please implement the logic\n        }\n        if (options.item.id === 'tabs') {\n          const childId = tools.createEmptyContainer()\n          const blockData: MFInsertBlockData = {\n            // The value must be the key of `EditorBlockConfig`\n            type: 'my-tabs',\n            children: [childId],\n            data: ['tab1'],\n            exportSpec: [\n              {\n                type: 'text',\n                data: 'tab1',\n              },\n              {\n                type: 'block',\n                data: [childId],\n              },\n            ],\n          }\n          return editor.insertBlock(containerId, blockIndex, blockData)\n        }\n        if (options.item.id === 'embed') {\n          const blockData: MFInsertBaseData = {\n            // The value must be the key of `EditorEmbedConfig`\n            type: 'embedType',\n            data: 'embed',\n            exportSpec: [\n              {\n                type: 'text',\n                data: 'embed',\n              },\n            ],\n          }\n          return editor.insertEmbed(containerId, blockIndex, blockData)\n        }\n      },\n    })\n  }, [editor, registerCommand, tools])\n  return (\n    <>\n      <RenderEditorBlock config={config} />\n      <RenderEditorEmbed config={embedConfig} />\n    </>\n  )\n}\n")),(0,i.kt)("admonition",{title:"caution",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"If you want to insert a block by the ",(0,i.kt)("inlineCode",{parentName:"p"},"editor.insertBlock")," API, you must use the ",(0,i.kt)("inlineCode",{parentName:"p"},"tools.createEmptyContainer")," to create\nthe ID for every editable block, and put them in the array of ",(0,i.kt)("inlineCode",{parentName:"p"},"MFInsertBlockData.children"),", because when the user copy\nor cut the block, the editor will update the ID in the ",(0,i.kt)("inlineCode",{parentName:"p"},"children"),". your custom data must be put in the\n",(0,i.kt)("inlineCode",{parentName:"p"},"MFInsertBlockData.data"),". If you want to get these data in the render component, you can get them by the\n",(0,i.kt)("inlineCode",{parentName:"p"},"EditorBlockProps.blockData.children")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"EditorBlockProps.blockData.pluginInfo.data"),"."),(0,i.kt)("p",{parentName:"admonition"},"More information about the ",(0,i.kt)("inlineCode",{parentName:"p"},"Block")," is ",(0,i.kt)("a",{parentName:"p",href:"#block"},"here"),".")),(0,i.kt)("h3",{id:"step-3-render-the-plugin"},"Step 3: Render the plugin"),(0,i.kt)("p",null,"After you insert the plugin. The platform will call the ",(0,i.kt)("inlineCode",{parentName:"p"},"render")," function by the type of the plugin data. For example,\nin the code above, if the type of the plugin data is ",(0,i.kt)("inlineCode",{parentName:"p"},"my-tabs"),"(This should be the same as the ",(0,i.kt)("inlineCode",{parentName:"p"},"MFInsertBlockData.type"),".\nIf the type is ",(0,i.kt)("inlineCode",{parentName:"p"},"Embed"),", this should be the same as the ",(0,i.kt)("inlineCode",{parentName:"p"},"EditorEmbedConfig.type"),"), so you must register a component to\nrender it."),(0,i.kt)("p",null,"Every block inserted by the plugin has a border which is rendered by the platform to show the information of the block.\nThe ",(0,i.kt)("inlineCode",{parentName:"p"},"icon")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"name")," are used to configure the information."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"const config: EditorBlockConfig = {\n  'my-tabs': {\n    render: BlockTabs,\n    icon: './logo.svg',\n    name: 'my-tabs',\n  },\n}\n\nfunction App() {\n  return (\n    <>\n      <RenderEditorBlock config={config} />\n    </>\n  )\n}\n")),(0,i.kt)("admonition",{title:"caution",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"The element used to accept data from the user(e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"<input>"),") can't be used in the block element(which intercept lots\nof DOM event, so the element can't respond to the input from the user). But the element wrapped by the ",(0,i.kt)("inlineCode",{parentName:"p"},"Modal")," from the\n",(0,i.kt)("inlineCode",{parentName:"p"},"@ones-design/core")," can accept the data from the user, because the element under the ",(0,i.kt)("inlineCode",{parentName:"p"},"Modal")," is inserted under the ",(0,i.kt)("inlineCode",{parentName:"p"},"document.body"),".")),(0,i.kt)("admonition",{title:"caution",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"The function in the ",(0,i.kt)("inlineCode",{parentName:"p"},"editor")," is synchronous, so try your best to put the function that changes the document in the ",(0,i.kt)("inlineCode",{parentName:"p"},"useLayoutEffect"),".\nOtherwise, maybe the editor will throw an error.")),(0,i.kt)("p",null,"Now the plugin supports three types of elements in the document, there are ",(0,i.kt)("inlineCode",{parentName:"p"},"Block"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"Embed"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"Box"),". The main\ndifference is the ",(0,i.kt)("inlineCode",{parentName:"p"},"Box")," can be inserted into the document around the text, and the ",(0,i.kt)("inlineCode",{parentName:"p"},"Block")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"Embed")," are the whole\nblock in the document."),(0,i.kt)("h4",{id:"block"},"Block"),(0,i.kt)(c,{img:n(1645),mdxType:"Image"}),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"Block"),"(The zone in the blue box) is the whole block in the document. You can insert the ",(0,i.kt)("inlineCode",{parentName:"p"},"Block")," into the document\nby the ",(0,i.kt)("inlineCode",{parentName:"p"},"editor.insertBlock")," function, and register a component to render the ",(0,i.kt)("inlineCode",{parentName:"p"},"Block")," by the component ",(0,i.kt)("inlineCode",{parentName:"p"},"RenderEditorBlock"),".\nIn the block, you can insert an editable block(The zone in the red box) that has the core functionality of the editor.\nThe editable block is also called the child container below."),(0,i.kt)("p",null,"For example, the table in the document is a ",(0,i.kt)("inlineCode",{parentName:"p"},"Block"),", the developer can determine the appearance of the table, and the cell\nis the editable block. And you can determine the cursor position in the cell by the lifecycle."),(0,i.kt)("p",null,"Below is an example to insert an editable block and get it in the code:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"const editor = useDefaultEditor()\n// This is used to append an editable block under the `div` container and the ID of the child container is the `props.blockData.children[0]`.\n// The ID must get from the `EditorBlockProps.blockData.children`.\neditor.createChildContainer(props.path, containerRef.current, props.blockData.children[0])\n\n// In the `props.registerLifeCycle`, you can get the child container by the API in the `useDefaultEditor`.\neditor.getContainerById(props.blockData.children[0])\n")),(0,i.kt)("p",null,"This is the lifecycle you can use:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"function BlockTabs(props: EditorBlockProps) {\n  const editor = useDefaultEditor()\n  const tools = useDefaultEditorTools()\n  const containerRef = useRef<HTMLDivElement>(null)\n  const activeTabKey = props.blockData.children[0]\n\n  const tabsInfo = useMemo(() => {\n    return props.blockData.children.map((item) => {\n      return {\n        key: item,\n        label: props.blockData.pluginInfo.data[0],\n      }\n    })\n  }, [props.blockData.children, props.blockData.pluginInfo.data])\n\n  useEffect(() => {\n    props.registerLifeCycle({\n      // Return the child container of the current block.\n      // If the `options?.visibleOnly` is `true`, you should only return the container element which is visible.\n      // For example, when the user try to move the cursor to the block, the `editor` will call this function and move the\n      // cursor to the right child container.\n      getChildContainers: (_, options) => {\n        // Please implement the logic\n      },\n      // Update the selected status of a child container\n      // When a child container is selected, the `clearSelection` runs first, and then the `updateSelection` runs.\n      // If the lifecycle is not defined, The block is selected by default when needed.\n      updateSelection() {\n        // Please implement the logic\n      },\n      // Clear the selected status of all child container\n      clearSelection() {\n        // Please implement the logic\n      },\n      // Return the selected child container element.\n      getSelectedContainers(complexBlock) {\n        // Please implement the logic\n      },\n      // If the block is visible.\n      // the block has two child containers. The first container has an annotation and is unvisitable. The second\n      // container is visible. When the user clicks the annotation. The editor will ask if the block where the\n      // annotation is located is visible. If the block is not visible, the editor will call the `showChildContainer`\n      // and switch to the first block.\n      isChildContainerVisible(block) {\n        // Please implement the logic\n      },\n      // Refer to `isChildContainerVisible`.\n      // When you try to show the container, you should wrap the component state with `flushSync`, because the editor inside is synchronous.\n      showChildContainer() {\n        // Please implement the logic\n      },\n      // When the user clicks a DOM which is not an editor block that the cursor can move to, this function will be\n      // called. You can return a child container, then the editor will move the cursor to the container.\n      getRangeFromPoint(block) {\n        // Please implement the logic\n      },\n      // Configure how to display the toolbar.\n      // The toolbar shows on the top of the block when the user hovers over it.\n      getBlockProperties() {\n        // Please implement the logic\n\n        // This will show the toolbar called `edit` on the top of the block.\n        // return {\n        //   commands: [\n        //     {\n        //       id: 'edit',\n        //       name: 'edit',\n        //       icon: './logo.svg',\n        //     },\n        //   ],\n        //   executeCommand(block, item) {\n        //     if (item.id === 'edit') {\n        //     }\n        //   },\n        // }\n      }\n    })\n  }, [activeTabKey, editor, props, tools])\n\n  useLayoutEffect(() => {\n    editor.createChildContainer(props.path, containerRef.current, props.blockData.children[0])\n  }, [editor, props.blockData.children, props.path])\n\n  return (\n    <>\n      <Tabs tabs={tabsInfo} activeTabKey={tabsInfo[0].key} />\n      <div ref={containerRef}></div>\n    </>\n  )\n}\n")),(0,i.kt)("h4",{id:"embed"},"Embed"),(0,i.kt)(c,{img:n(42537),mdxType:"Image"}),(0,i.kt)("p",null,"You can insert the ",(0,i.kt)("inlineCode",{parentName:"p"},"Embed")," into the document by the ",(0,i.kt)("inlineCode",{parentName:"p"},"editor.insertEmbed")," function, and register a component to render\nthe ",(0,i.kt)("inlineCode",{parentName:"p"},"Embed")," by the component ",(0,i.kt)("inlineCode",{parentName:"p"},"RenderEditorEmbed"),"."),(0,i.kt)("p",null,"This is the same as the ",(0,i.kt)("inlineCode",{parentName:"p"},"Block"),", but the ",(0,i.kt)("inlineCode",{parentName:"p"},"Embed")," is a special block. You can't insert an editable block in the ",(0,i.kt)("inlineCode",{parentName:"p"},"Embed"),".\nWhen the cursor move to the ",(0,i.kt)("inlineCode",{parentName:"p"},"Embed"),", the whole ",(0,i.kt)("inlineCode",{parentName:"p"},"Embed")," block is selected. The ",(0,i.kt)("inlineCode",{parentName:"p"},"Embed")," is not editable."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"function EmbedBlock(props: EditorEmbedProps) {\n  return <span>test</span>\n}\n\nconst embedConfig: EditorEmbedConfig = {\n  embedType: {\n    render: EmbedBlock,\n    name: 'embed',\n    icon: './logo.svg',\n  },\n}\n\nfunction App() {\n  return (\n    <>\n      <RenderEditorEmbed config={embedConfig} />\n    </>\n  )\n}\n")),(0,i.kt)("h4",{id:"box"},"Box"),(0,i.kt)("admonition",{title:"caution",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Now the ",(0,i.kt)("inlineCode",{parentName:"p"},"Box")," can't be exported to ",(0,i.kt)("inlineCode",{parentName:"p"},"PDF/Word"),".")),(0,i.kt)(c,{img:n(9763),mdxType:"Image"}),(0,i.kt)("p",null,"You can insert the ",(0,i.kt)("inlineCode",{parentName:"p"},"Box"),"(the zone in the blue zone) into the text block(the zone in the red zone) by the\n",(0,i.kt)("inlineCode",{parentName:"p"},"editor.insertBoxToBlock")," function, and register a function to render the ",(0,i.kt)("inlineCode",{parentName:"p"},"Box")," by the hook ",(0,i.kt)("inlineCode",{parentName:"p"},"useRegisterBoxConfig"),"."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"Box")," is an inline element. You can't use the react component to render the ",(0,i.kt)("inlineCode",{parentName:"p"},"Box"),". When the data of the block that the box\nis located is changed, the ",(0,i.kt)("inlineCode",{parentName:"p"},"Box")," will be re-rendered. Before the editor commits the DOM, the editor first diff the new DOM with\nthe old DOM. If the DOM is not changed, the new DOM will be dropped. But in some cases, the new DOM will be accepted by the editor,\nyou should not depend on this algorithm, don't register the event listener in the DOM."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { useRegisterBoxConfig } from \"@ones-op/editor\"\n\nfunction App() {\n  const getConfig = useCallback(() => {\n    return {\n      boxType: {\n        name: 'box',\n        icon: './logo.svg',\n        // This is used to listen the click event.\n        handleClickBox(box, boxData) {\n          // Please implement the logic\n        },\n        // When an box is need to render, this function will be called.\n        updateBoxContent(boxData) {\n          // Please implement the logic\n        },\n      },\n    }\n  }, [])\n  useRegisterBoxConfig(getConfig)\n\n  return (\n    <>\n      <RenderEditorBlock config={config} />\n      <RenderEditorEmbed config={embedConfig} />\n    </>\n  )\n}\n")),(0,i.kt)("h3",{id:"step-4-export-to-pdfword"},"Step 4: Export to PDF/Word"),(0,i.kt)("p",null,"While inserting and updating the data, the plugin needs to tell the editor how to export this data when the user export it to a word or PDF(for example, the issue plugin will save the ID into the document. When exported to PDF, this data will render as a link). When you need to export an image, make sure the image has been uploaded to the server of the editor by calling the ",(0,i.kt)("inlineCode",{parentName:"p"},"editor.doc.uploadResource"),", the server will return the file name of the resource."),(0,i.kt)("p",null,"If you want to export the content of the child container in the ",(0,i.kt)("inlineCode",{parentName:"p"},"Block"),", you should add the ID of the child container to the ",(0,i.kt)("inlineCode",{parentName:"p"},"exportSpec")," array. See the code below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"editor.doc.uploadResource(file).then((url) => {\n  editor.updateEmbedData(props.blockElement, {\n    type: 'embedType',\n    data: {\n      //\n    },\n    exportSpec: [\n      {\n        type: 'image',\n        data: url.resourceId,\n      },\n      {\n        type: 'block',\n        data: [childContainerID]\n      },\n      {\n        type: 'string',\n        data: 'test'\n      },\n      {\n        type: 'link',\n        data: {\n            url: 'https://www.example.com',\n            title: 'test';\n        }\n      }\n    ],\n    // If you use the `editor.doc.uploadResource` to upload your resource and not export it as an image. You should add\n    // the resource to the `resources` array. Otherwise, the resource is invalid in the new document into which it\u2019s copied.\n    resources: [],\n  })\n})\n")))}g.isMDXComponent=!0}}]);